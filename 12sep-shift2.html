<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>SSC CGL — 12 Sep Shift 2 (Mock)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --blue:#153d7a;
      --accent:#1f4d8a;
      --green:#28a745;
      --red:#d9534f;
      --marked:#7b3fb0;
      --muted:#6b7280;
      --card:#ffffff;
      --bg:#f3f6fb;
      --correct:#dff5e0;
      --wrong:#fff0f0;
      --highlight:#e8f2ff;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:var(--bg);color:#17202a}
    .topbar{background:linear-gradient(90deg,var(--blue),#2b62b0);color:#fff;padding:12px 18px;display:flex;align-items:center;justify-content:space-between;position:relative}
    .brand{display:flex;align-items:center;gap:12px}
    .brand .logo{width:44px;height:44px;border-radius:8px;background:#fff;color:var(--blue);display:flex;align-items:center;justify-content:center;font-weight:900}
    .brand h1{margin:0;font-size:18px;letter-spacing:0.2px}
    .controls{display:flex;gap:10px;align-items:center}
    .btn{background:var(--accent);color:#fff;border:0;padding:8px 12px;border-radius:6px;cursor:pointer;font-weight:700}
    .btn.ghost{background:#fff;color:var(--accent);border:1px solid #dfe7f3}
    .timer{font-weight:800;background:#ffdede;color:#b30000;padding:6px 10px;border-radius:6px}
    .layout{display:flex;gap:16px;padding:16px;height:calc(100vh - 72px);align-items:flex-start}
    /* left panel */
    .left{width:320px;background:var(--card);border-radius:10px;padding:14px;box-shadow:0 6px 18px rgba(16,24,40,0.06);display:flex;flex-direction:column;gap:12px;overflow:auto}
    .sections{display:flex;flex-direction:column;gap:8px}
    .section-btn{background:var(--accent);color:#fff;border:0;padding:8px;border-radius:6px;text-align:left;cursor:pointer;font-weight:800}
    .section-btn.active{background:var(--green)}
    .qgrid{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .qnum{width:44px;height:38px;border-radius:6px;display:flex;align-items:center;justify-content:center;font-weight:800;background:var(--accent);color:#fff;cursor:pointer;border:0}
    .qnum.answered{background:var(--green)}
    .qnum.skipped{background:var(--red)}
    .qnum.marked{background:var(--marked)}
    .summary{margin-top:auto;background:#f6f9ff;padding:10px;border-radius:8px;color:var(--muted);font-weight:700}
    /* main area */
    .main{flex:1;display:flex;flex-direction:column;height:100%}
    .controls-row{background:var(--card);padding:12px;border-radius:10px;display:flex;gap:8px;align-items:center;box-shadow:0 6px 18px rgba(16,24,40,0.04)}
    .qcard{flex:1;background:var(--card);margin-top:12px;border-radius:10px;padding:18px;box-shadow:0 6px 18px rgba(16,24,40,0.04);overflow:auto;min-height:300px}
    .qheader{font-weight:800;margin-bottom:12px}
    .qtext{font-size:15px;line-height:1.6}
    .options{margin-top:12px;display:flex;flex-direction:column;gap:10px}
    .opt{border:1px solid #e8eef8;padding:12px;border-radius:8px;display:flex;gap:10px;align-items:center;cursor:pointer;background:#fff}
    .opt.disabled{opacity:0.6;pointer-events:none}
    .opt.correct{background:var(--correct);border-color:rgba(40,162,69,0.25)}
    .opt.wrong{background:var(--wrong);border-color:rgba(217,83,79,0.2)}
    .opt input{transform:scale(1.0);margin-right:8px}
    .footer{display:flex;justify-content:space-between;align-items:center;margin-top:12px;padding:10px 4px}
    .small{color:var(--muted);font-weight:700}
    /* results & review */
    #resultsArea{display:none;padding:18px}
    .results{padding:20px;background:var(--card);border-radius:10px;box-shadow:0 6px 18px rgba(16,24,40,0.04)}
    table{border-collapse:collapse;width:100%}
    th,td{border:1px solid #e9eef8;padding:10px;text-align:left}
    .overlay{
      position:fixed;inset:0;background:rgba(10,10,10,0.45);display:flex;align-items:center;justify-content:center;z-index:50;
    }
    .start-card{background:#fff;padding:36px;border-radius:12px;box-shadow:0 10px 40px rgba(16,24,40,0.3);text-align:center}
    .start-card h1{margin:0 0 12px 0;font-size:28px}
    .start-card p{color:#666;margin:6px 0 18px}
    .small-muted{font-size:12px;color:#6b7280}
    .paused-badge{position:fixed;top:84px;right:26px;background:rgba(0,0,0,0.6);color:#fff;padding:8px 12px;border-radius:8px;font-weight:800;display:none;z-index:60}
    .review-tabs{display:flex;gap:8px;margin-bottom:12px}
    .tab{padding:8px 10px;border-radius:8px;background:#f3f6fb;cursor:pointer;font-weight:800}
    .tab.active{background:var(--accent);color:#fff}
    .review-list{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
    .rev-q{padding:8px;border-radius:6px;background:#fff;border:1px solid #e6eef8;cursor:pointer;text-align:center}
    /* responsive */
    @media(max-width:980px){
      .layout{flex-direction:column;height:auto}
      .left{width:100%;display:flex;order:2}
      .main{order:1}
    }
  </style>
</head>
<body>

  <div class="topbar">
    <div class="brand">
      <div class="logo">SSC</div>
      <div>
        <h1 id="examTitle">SSC CGL — 12 Sep Shift 2</h1>
        <div style="font-size:12px;color:rgba(255,255,255,0.9)">Full Mock — 60 minutes · Single-question view</div>
      </div>
    </div>

    <div class="controls">
      <div style="text-align:right">
        <div class="small" style="color:#fff">Total Answered: <span id="totalAnswered">0</span></div>
        <div style="margin-top:6px;display:flex;gap:8px;align-items:center">
          <div class="timer" id="timeBox">60:00</div>
          <button id="fsBtn" class="btn ghost" title="Toggle Fullscreen">Full screen</button>
        </div>
      </div>
      <button id="submitTop" class="btn" title="Submit exam">Submit</button>
    </div>
  </div>

  <div class="layout">
    <!-- LEFT PANEL -->
    <aside class="left">
      <div style="display:flex;align-items:center;gap:10px">
        <div style="font-weight:800;font-size:16px;color:var(--blue)">Sections</div>
      </div>

      <div class="sections" id="sectionList">
        <!-- JS populates sections -->
      </div>

      <div style="font-weight:800;color:var(--blue);margin-top:6px">Question Panel</div>
      <div class="qgrid" id="qGrid"><!-- populated by JS --></div>

      <div class="summary">
        <div>Section Summary</div>
        <div style="margin-top:8px">Answered: <span id="secAnswered">0</span></div>
        <div>Not Answered: <span id="secNotAnswered">0</span></div>
      </div>
    </aside>

    <!-- MAIN AREA -->
    <main class="main">
      <div class="controls-row">
        <button id="prevBtn" class="btn ghost">Previous</button>
        <button id="clearBtn" class="btn ghost">Clear Response</button>
        <button id="markBtn" class="btn ghost" style="background:#fff;color:var(--marked);border:1px solid #e9def7">Mark for Review</button>
        <button id="saveNextBtn" class="btn">Save & Next</button>

        <div style="margin-left:auto;display:flex;gap:10px;align-items:center">
          <button id="pauseBtn" class="btn ghost">Pause</button>
          <button id="restartBtn" class="btn ghost" style="background:#cfcfcf;color:#111">Restart Exam</button>
        </div>
      </div>

      <div class="qcard" id="qCard">
        <div class="qheader" id="qHeader">Question</div>
        <div class="qtext" id="qText">Loading...</div>

        <div class="options" id="optsWrap"></div>

        <div class="footer">
          <div>
            <button id="reviewAnswersBtn" class="btn ghost" style="display:none">Review Answers</button>
          </div>
          <div class="small">Questions answered: <strong id="footerAnswered">0</strong></div>
        </div>
      </div>
    </main>
  </div>

  <!-- RESULTS / REVIEW AREA -->
  <div id="resultsArea" style="display:none;padding:18px">
    <div class="results" id="resultsCard">
      <h2>Markcard & Review</h2>
      <div id="markcardSummary"></div>

      <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
        <div class="review-tabs" id="reviewTabs"></div>
        <div style="margin-left:auto;display:flex;gap:8px">
          <button id="viewMarkcardBtn" class="btn">View Markcard</button>
          <button id="backToExamBtn" class="btn ghost">Back to Exam</button>
        </div>
      </div>

      <div id="reviewContent" style="margin-top:12px"></div>
    </div>
  </div>

  <!-- START OVERLAY -->
  <div id="startOverlay" class="overlay">
    <div class="start-card">
      <h1>Start Exam</h1>
      <p class="small-muted">SSC CGL — 12 Sep Shift 2 &nbsp;•&nbsp; Duration: 60 minutes</p>
      <div style="margin-top:18px">
        <button id="startBtn" class="btn" style="font-size:18px;padding:14px 22px">Start Exam</button>
      </div>
      <p style="margin-top:14px;color:#666;font-size:13px">Click start to enter full-screen and begin.</p>
    </div>
  </div>

  <div id="pausedBadge" class="paused-badge">PAUSED</div>

<script>
/* -------------------------
  QUESTIONS: SHIFT 2 (1-100)
  (User provided full text; included here as array per section)
   Sections:
     A - Reasoning (1-25)
     B - General Awareness (26-50)
     C - Quantitative Aptitude (51-75)
     D - English Comprehension (76-100)
   Answer key embedded below.
--------------------------*/

const ANSWER_KEY = {
  "1":"C","2":"C","3":"D","4":"A","5":"A","6":"A","7":"B","8":"A","9":"B","10":"B",
  "11":"A","12":"A","13":"B","14":"D","15":"D","16":"B","17":"C","18":"C","19":"A","20":"A",
  "21":"A","22":"A","23":"B","24":"C","25":"B","26":"A","27":"C","28":"D","29":"A","30":"B",
  "31":"C","32":"A","33":"B","34":"A","35":"C","36":"C","37":"B","38":"C","39":"B","40":"B",
  "41":"C","42":"C","43":"D","44":"B","45":"A","46":"B","47":"D","48":"B","49":"D","50":"C",
  "51":"C","52":"B","53":"A","54":"B","55":"B","56":"B","57":"B","58":"D","59":"C","60":"B",
  "61":"B","62":"A","63":"B","64":"B","65":"D","66":"A","67":"A","68":"A","69":"C","70":"A",
  "71":"A","72":"C","73":"B","74":"A","75":"B","76":"C","77":"B","78":"A","79":"C","80":"A",
  "81":"A","82":"A","83":"C","84":"B","85":"C","86":"D","87":"C","88":"B","89":"B","90":"C",
  "91":"C","92":"C","93":"C","94":"C","95":"A","96":"C","97":"A","98":"C","99":"A","100":"A"
};

/* QUESTIONS array. For brevity I include the text exactly as you provided (trimmed where needed).
   Each question object: {id, q, options:[...]}.
   Note: Some OCR lines had minor duplicate or formatting. I preserved user text content.
*/

const SECTIONS = [
  { key: 'A', name:'Reasoning', items: [
    {"id":1,"q":"In the following question, select the related word from the given alternatives\nLiberty : Autonomy :: Equality : ?","options":["Legitimacy","Neutrality","Fairness","Diversity"]},
    {"id":2,"q":"Select the letter-cluster from among the given options that can replace the question mark (?) in the following series.\nBGL GLQ LQV,QVA ?","options":["785","(option placeholder)","(option placeholder)","(option placeholder)"]},
    {"id":3,"q":"Select the letter-cluster from among the given options that can replace the question mark (?) in the following series.\nDAG, FCI, ?, JGM, 110","options":["GDJ","IFL","HKE","HEK"]},
    {"id":4,"q":"Which of the following alternatives will replace the question mark?\nAtom, Molecule, Cell, ?","options":["Tissue","Proton","System","Gene"]},
    {"id":5,"q":"Complete the series: 148, 361, 361, 247, 247 ...","options":["(A)","(B)","(C)","(D)"]},
    {"id":6,"q":"What will come at the place of question mark? 2, 12, 30, 56, 90, ?","options":["132","140","142","150"]},
    {"id":7,"q":"Read the following statement carefully and identify the conclusion that follows.\nStatement: Most farmers in the region depend on monsoon rains for irrigation.\nConclusions:\n1. The region does not have proper irrigation infrastructure.\n2. A weak monsoon may reduce agricultural output.","options":["Conclusion 1 follows","Only Conclusion II follows","Only Conclusion I follows","Both I and II follow"]},
    {"id":8,"q":"Instruction: Identify the assumptions that must hold for the statement to be valid, then choose the correct option.\nStatement: The discovery of exoplanets in habitable zones around distant stars has provided exciting prospects for the search for extraterrestrial life, yet the vast distances and technological limitations pose significant obstacles to direct exploration.\nAssumptions:\n1. Exoplanets located in habitable zones may have the potential to support life.\n2. Current technology is insufficient to directly explore exoplanets in habitable zones.\n3. Direct exploration of exoplanets will be unnecessary if we detect signs of life remotely.","options":["Only I and II are implicit","Only I is implicit","All assumptions are implicit","Only II is implicit"]},
    {"id":9,"q":"How many meaningful four-letter English words can be formed using the first, second, third, and sixth letters of the word \"PROVIDE\" (when counted from left to right), using each letter only once in each word?","options":["One","Two","Three","None"]},
    {"id":10,"q":"Which of the following addresses are identical to each other:\n1. Rajeev Chauhan 3/5, Lotus Enclave, Kanpur, 208012\n2. Rajeev Chauhan 3-5, Lotus Enclave, Kanpur , 208012\n3. Rajeev Chauhan 3-5, Lotus Enclave, Kanpur, 208012\n4. Rajeev Chauhan 3-5, Lotus Enclave, Kanpur, 208002","options":["1 and 2","1 and 3","2 and 3","3 and 4"]},
    {"id":11,"q":"Each of the letters in the word STAMINA is arranged in alphabetical order. How many letters are there in the English alphabetical series between the letter that is first from the left and the one that is fourth from the right in the new letter-cluster formed?","options":["11","12","13","14"]},
    {"id":12,"q":"Find the best option that best completes the analogy.\nNPR:OQS :: XVZ:?","options":["YZA","ZAB","YAC","YAZ"]},
    {"id":13,"q":"In a row of 50 books, Book A is 15th from left and Book B is 20th from right. How many books lie between them?","options":["17","16","18","19"]},
    {"id":14,"q":"In each of the following questions, the second word is formed by rearranging the letters of the first word according to a specific pattern. Identify that pattern and apply the same to the third word to find the correct answer from the given alternatives.\nNUMERAL : UEALRMN :: ALGEBRA : ?","options":["LRBAGEA","BARLAGE","LERAGBA","LERABGA"]},
    {"id":15,"q":"Find the odd one out from the given alternatives: TDS, GST, VAT, DNA","options":["TDS","GST","VAT","DNA"]},
    {"id":16,"q":"If A is the son of B, and B is the brother of C, how is C related to A?","options":["Father","Uncle","Brother","Cousin"]},
    {"id":17,"q":"One number is not like the others: 1331, 2197, 3375, 4096","options":["1331","3375","4096","2197"]},
    {"id":18,"q":"Find the number that breaks the pattern: 2, 5, 10, 17, 28, 40, 58","options":["10","17","28","40"]},
    {"id":19,"q":"In a certain code language, if MOUSE is coded as 45291 and RAT as 786, how is STORE coded?","options":["96571","97653","98345","96278"]},
    {"id":20,"q":"If 7 $ 3 = 58 and 6 $ 2 = 40, what is 5 $ 1?","options":["24","28","22","26"]},
    {"id":21,"q":"Pointing to a girl, a woman says, 'She is the daughter of my mother's only daughter.' How is the girl related to the woman?","options":["Daughter","Daughter-in-law","Cousin","Sister"]},
    {"id":22,"q":"A woman says, 'This man's son's sister is my daughter.' How is the woman related to the man?","options":["Wife","Daughter-in-law","Sister","Mother"]},
    {"id":23,"q":"Two numbers are in ratio 7:9, and their sum is 128. Find the numbers.","options":["49,79","56,72","62,66","70,58"]},
    {"id":24,"q":"If 16+11 = A and 91—5 = B, and A % B = (A × B) − 1, then what is A % B?","options":["(A)","(B)","(C)","(D)"]},
    {"id":25,"q":"If the sum of 28 and 22 is multiplied by 8, what is the result?","options":["384","400","415","416"]}
  ]},
  { key:'B', name:'General Awareness', items: [
    {"id":26,"q":"Read the below statements marked as Assertion (A) and Reason (R). Mark the correct option:\nAssertion (A): Humayun's Tomb was the first major Mughal garden tomb and directly inspired the design of the Taj Mahal.\nReason (R): It introduced the charbagh garden layout and double-domed mausoleum style that became characteristic of later Mughal architecture.","options":["Both A and R are true, and R is the correct explanation of A.","Both A and R are true, but R is not the correct explanation of A.","A is true, R is false.","A is false, R is true."]},
    {"id":27,"q":"Which ancient ruler’s administration is noted for its highly centralized structure?","options":["Harshavardhana","Samudragupta","Chandragupta Maurya","Pulakeshin II"]},
    {"id":28,"q":"Which of the following correctly reflects the evolution of Indian classical music?","options":["Jatis evolved from ragas as per ancient texts","72-mela system was given by Bharata in 13th century","Folk music originally used mela and grama scales","Raga evolved from jatis; 72-mela was by Venkatamakhi"]},
    {"id":29,"q":"Consider the following statements about the phases of long jump:\n1) The athlete attains maximum momentum by running on the runway before take-off.\n2) During take-off, the athlete pushes off with the weaker foot to maintain balance.\nWhich of the statements given above are correct?","options":["Only 1 is Correct","Only 2 is Correct","1 and 2 are correct","Neither 1 nor 2 are Correct"]},
    {"id":30,"q":"Mary Kom's most recent international gold medal was won at which tournament?","options":["Asian Games, Hangzhou","President’s Cup, Indonesia","Commonwealth Games, Birmingham","Olympic Games, Tokyo"]},
    {"id":31,"q":"The Regulating Act of 1773 primarily introduced changes in the Company's administration in which two distinct areas?","options":["Company's Judicial system and revenue collection.","Company's Military strategy and trade regulations.","Company's constitution at home and territorial control in India.","Company's relations with princely states and foreign policy."]},
    {"id":32,"q":"Consider the following statements regarding India’s water-sharing treaties with its neighbours:\n1) The Mahakali Treaty (1996) includes provisions for integrated development of the Mahakali River and the Pancheshwar Project.\n2) The Ganga Water Treaty (1996) allows for the sharing of Ganga waters at Farakka throughout the entire year.\nWhich of the statements above is/are correct?","options":["Only 1 is Correct","Only 2 is Correct","Both 1 and 2 are Correct","Neither 1 nor 2 are Correct"]},
    {"id":33,"q":"Fill in the blank:\nUnder the SLKIC vertical of Khelo India, Kendriya Vidyalayas have been adopted in partnership with KVS.","options":["(answer blank)","(answer blank)","(answer blank)","(answer blank)"]},
    {"id":34,"q":"Consider the following statements about 'The Adventures of Kakababu, Volume 1' by Sunil Gangopadhyay:\n1) A pioneering Bengali adventure novel featuring detective Kakababu with mystery and cultural themes.\n2) A political satire on post-independence Indian governance.\n3) An autobiography of the author’s freedom fighter experiences in Bengal.\nWhich of the above statements is/are correct?","options":["Only statement 1 is correct","Only statement 2 is correct","Statements 2 and 3 are correct","1, 2 and 3 are correct"]},
    {"id":35,"q":"Which Indian political leader addressed a special session in 2025 on 'Environment, COP-30, and Global Health'?","options":["Piyush Goyal","Hardeep Puri","Narendra Modi","S. Jaishankar"]},
    {"id":36,"q":"Which of the following types of landslides involves backward rotation of the slipping material?","options":["Rockslide","Rock fall","Slump","Debris fall"]},
    {"id":37,"q":"What is meant by population density?","options":["Population per household","People per square kilometre","People per region","People per district"]},
    {"id":38,"q":"Assertion (A): Population explosion occurs when death rates decline rapidly but birth rates remain high.\nReason (R): Societal reproductive behavior changes instantly with improvements in healthcare.\nChoose the correct option.","options":["Both A and R are true, and R is the correct explanation of A.","Both A and R are true, but R is not the correct explanation of A.","A is true, but R is false.","A is false, but R is true."]},
    {"id":39,"q":"Which of the following best reflects the fundamental objective of applying generative design in aerospace systems engineering?","options":["Facilitating seamless integration of multi-payload platforms in shared bus structures","Optimizing mechanical configurations for minimum mass and maximum structural resilience","Enhancing life-support redundancies for crew safety","Designing adaptive thrust mechanisms to control orbital corrections"]},
    {"id":40,"q":"The function of lysosomes in cells is:","options":["Protein synthesis","Intracellular digestion","Energy production","Genetic information storage"]},
    {"id":41,"q":"Which of the following statements regarding Article 270 are correct?\n1) Article 270 governs the sharing of taxes between the Union and States, including proceeds from GST.\n2) After the 101st Constitutional Amendment, Article 270 includes provisions for distributing revenue from Union taxes and GST.\n3) The GST Compensation Cess is also shared between the Union and States under Article 270.","options":["1 and 3 only","1 Only","1 & 2 only","2 & 3 only"]},
    {"id":42,"q":"If Earth's radius were reduced by 1% while its mass remained unchanged, what would be the effect on the gravitational acceleration at its surface?","options":["Increase by approximately 1%","Decrease by approximately 2%","Increase by approximately 2%","Decrease by approximately 1%"]},
    {"id":43,"q":"Under Bharatiya Nagarik Suraksha Sanhita (BNSS), what is the maximum period for which a person can be held in police custody in total, even if remanded periodically by a magistrate?","options":["30 days","60 days","90 days","15 days (for initial remand, extendable)"]},
    {"id":44,"q":"What is the age range for farmers to enrol in the Pradhan Mantri Kisan Maandhan Yojana (PM-KMY)?","options":["18-30 years","18-40 years","21-45 years","25-50 years"]},
    {"id":45,"q":"Read the below statements marked as Assertion (A) and Reason (R). Mark the correct option:\nAssertion (A): UDAN Scheme improves regional air connectivity.\nReason (R): It provides financial viability gap funding to airlines.","options":["Both A and R are true, and R is the correct explanation of A.","Both A and R are true, but R is not the correct explanation of A.","A is true, but R is false.","A is false, but R is true."]},
    {"id":46,"q":"According to the Global Cities Index 2025 by Oxford Economics, which two cities retained their top positions?","options":["Tokyo & Beijing","London & New York","Paris & Rome","Berlin & Moscow"]},
    {"id":47,"q":"Which of the following statements about light industries is correct?","options":["They process heavy ores and minerals.","They produce large-scale industrial machinery.","They require bulky and heavy raw materials.","They use light materials to make consumer goods."]},
    {"id":48,"q":"Schedule VII of the Constitution contains:","options":["Election guidelines","Three legislative lists","Emergency powers","Judicial provisions"]},
    {"id":49,"q":"A coastal city builds sea walls and elevates buildings to respond to rising sea levels. This action primarily falls under which category of climate change response?","options":["Climate change mitigation","Carbon sequestration","Geoengineering","Climate change adaptation"]},
    {"id":50,"q":"What specific physical quantity ensures a satellite maintains its orbit without continuous propulsion?","options":["Mass","Gravitational pull","Orbital velocity","Atmospheric drag"]}
  ]},
  { key:'C', name:'Quantitative Aptitude', items: [
    {"id":51,"q":"Let x = √3 + √5 and y = √8 + √2. Which is greater?","options":["x","y","Cannot be determined","Equal"]},
    {"id":52,"q":"The number of red, blue, and green marbles in a bag is in the ratio 3:4:6. If 20 red marbles, 15 blue marbles, and an unknown number of green marbles are added to the bag, the ratio becomes 4:5:7. Determine the number of green marbles added.","options":["(A)","(B)","(C)","(D)"]},
    {"id":53,"q":"Evaluate the continued fraction: x = 2 + 1/(2 + 1/(2 + ...)).","options":["(A)","(B)","(C)","(D)"]},
    {"id":54,"q":"A and B invest 40,000 and 60,000 respectively in a business. What is A's share in a profit of 50,000?","options":["₹15,000","₹20,000","₹25,000","₹30,000"]},
    {"id":55,"q":"A and B contribute to a business in ratio 3:5. They earn a profit of ₹64,000. A is a working partner and receives 10% of the profit extra. What is A's total share?","options":["(A)","(B)","(C)","(D)"]},
    {"id":56,"q":"In a team of 75 employees, the average monthly sales per employee is ₹1.8 lakh. If 30 junior employees average ₹1.2 lakh each, what is the average monthly figure for the senior employees (in lakh)?","options":["₹2.2 lakh","₹2.8 lakh","₹1.42 lakh","Other"]},
    {"id":57,"q":"Petrol price increased by 5%. Before the hike, the price was ₹82 per litre. A man travels 3045 km every month and his car gives a mileage of 15 km per litre. What is the increase in the monthly expenditure (nearest ₹) due to the hike?","options":["2820","7820","7845","7850"]},
    {"id":58,"q":"A company placed an order for 20 high-end laptops and some quantity of standard desktops. Price of a high-end laptop was 5 times a standard desktop. Due to a mistake, the number of laptops and desktops was interchanged in delivery causing total bill to increase by 80%. What was the ratio of high-end laptops to standard desktops in the original order?","options":["1:2","2:5","(C)","(D)"]},
    {"id":59,"q":"Find the compound interest on ₹78,000 at 12% per annum for 3 years 4 months, compounded annually.","options":["₹3,000","₹73,689","₹73,600","Other"]},
    {"id":60,"q":"A candy shop owner buys red (3 for ₹15), blue (4 for ₹18), and green (5 for ₹22) candies and mixes them in ratio 1:1:2. He sells mixed candies 2 for ₹10. What is approximate gain/loss %?","options":["Loss of 9.2%","Profit of 9.29%","Profit of 10%","Loss of 10%"]},
    {"id":61,"q":"The ratio of boys to girls in a school is 7:5. If 20 more girls join, the new ratio becomes 7:6. What was the total number of students initially?","options":["200","240","300","360"]},
    {"id":62,"q":"A, B, and C can complete a job in 30, 45, and 90 days respectively. A works every day, while B and C join A every fifth day. How long to finish?","options":["25 days","18 days","16 days","12 days"]},
    {"id":63,"q":"A 100-litre solution contains acid and water in ratio 3:2. Some quantity is removed and replaced with pure acid. If final ratio becomes 7:3, how many litres replaced?","options":["35","25","50","20"]},
    {"id":64,"q":"Efficiencies of P and Q are in ratio 5:2. If P completes a project in 12 days, how many days will Q take alone?","options":["24 days","30 days","35 days","40 days"]},
    {"id":65,"q":"A car starts from point P on a circular track; an SUV starts from Q 600 m ahead. Car speed 15 m/s, SUV 10 m/s. Track circumference 1.5 km. How much distance will the car have traveled when it first overtakes the SUV?","options":["900 m","1200 m","1500 m","1800 m"]},
    {"id":66,"q":"A circular park has radius 14 m. If a 1.5 m wide path is built around it, what is approximate area of the path?","options":["139 m²","135 m²","142 m²","150 m²"]},
    {"id":67,"q":"What is (4π/5) radians in degrees?","options":["180°","240°","360°","Other"]},
    {"id":68,"q":"The line y = −x + 4 passes through which of the following points?","options":["(2, 2)","(5, 4)","(1, 2)","(3, 6)"]},
    {"id":69,"q":"What is the central angle of a sector with an arc length 10 cm in a circle of radius 5 cm?","options":["6 radians","3 radians","2 radians","4 radians"]},
    {"id":70,"q":"If tan(90° − A) = √3, what is sin A?","options":["(A)","(B)","(C)","(D)"]},
    {"id":71,"q":"If x = √7, determine the value of x + x⁻¹.","options":["(A)","(B)","(C)","(D)"]},
    {"id":72,"q":"Two similar triangles have sides in ratio 3:5. What is the ratio of their areas?","options":["9:25","3:5","(C)","(D)"]},
    {"id":73,"q":"If x = (expression), determine value of x² + x − 9. (Original expression in paper.)","options":["3√3","7√3","9√3","Other"]},
    {"id":74,"q":"Angles of a cyclic quadrilateral are in ratio 1:2:3:4. What is the measure of the smallest angle?","options":["36°","72°","108°","144°"]},
    {"id":75,"q":"If sec A = 5/3 and A is acute, find sin A.","options":["(A)","(B)","(C)","(D)"]}
  ]},
  { key:'D', name:'English Comprehension', items: [
  {
    "id": 76,
    "q": "Select the most appropriate synonym of the given word: ABNEGATE",
    "options": [
      "A. Demand",
      "B. Accept",
      "C. Renounce",
      "D. Support"
    ]
  },
  {
    "id": 77,
    "q": "Choose the correct meaning of idiom: Move heaven and earth",
    "options": [
      "A. To relocate frequently",
      "B. To work tirelessly to achieve something",
      "C. To stay silent in protest",
      "D. To follow blindly"
    ]
  },
  {
    "id": 78,
    "q": "Select the most appropriate antonym of the given word. Puissant",
    "options": [
      "A. Robust",
      "B. Powerful",
      "C. Strong",
      "D. (no option)"
    ]
  },
  {
    "id": 79,
    "q": "Identify the misspelt word",
    "options": [
      "A. Supersede",
      "B. Perseverance",
      "C. Priviledge",
      "D. Assassinate"
    ]
  },
  {
    "id": 80,
    "q": "Spot the correct spelling of a drug-effect psychology field.",
    "options": [
      "A. Psychopharmacology",
      "B. Psychopharmacholog",
      "C. Psychopharmeocology",
      "D. Psychopharmocology"
    ]
  },
  {
    "id": 81,
    "q": "Choose the correct one-word substitute for: 'A person who abstains from all forms of indulgence'.",
    "options": [
      "A. Ascetic",
      "B. Agnostic",
      "C. Mystic",
      "D. Skeptic"
    ]
  },
  {
    "id": 82,
    "q": "Select the correct option:\nNeither the principal investigator ___ the co-authors anticipated the backlash.",
    "options": [
      "A. or",
      "B. and",
      "C. nor did",
      "D. (no option)"
    ]
  },
  {
    "id": 83,
    "q": "Select the correct option:\nThe board will convene next Friday, ___ final approval is expected.",
    "options": [
      "A. at which",
      "B. on which",
      "C. when",
      "D. whereupon"
    ]
  },
  {
    "id": 84,
    "q": "Select the correct option:\nNothing short of a paradigm shift will ___ the entrenched bureaucratic inertia.",
    "options": [
      "A. persuade",
      "B. dislodge",
      "C. dissuasion",
      "D. disillusion"
    ]
  },
  {
    "id": 85,
    "q": "Find the part of the sentence that contains an error:\nMuch of what appears to be coordination (1)/ among the regulatory bodies and private stakeholders (2)/ are, in fact, coincidental overlaps (3)/ caused by differing mandates. (4)",
    "options": [
      "A. (1)",
      "B. (2)",
      "C. (3)",
      "D. (4)"
    ]
  },
  {
    "id": 86,
    "q": "Find the part of the sentence that contains an error:\nThat the framework lacks provisions for backward compatibility (1)/ is less problematic than the assumption (2)/ that all peripheral institutions will, without coercion, (3)/ adheres to the central directive as framed. (4)",
    "options": [
      "A. (1)",
      "B. (2)",
      "C. (3)",
      "D. (4)"
    ]
  },
  {
    "id": 87,
    "q": "Change the following from active to passive:\nPeople can seldom access archived manuscripts without clearance.",
    "options": [
      "A. Archived manuscripts can seldom being accessed without clearance.",
      "B. Archived manuscripts could seldom be accessed without clearance.",
      "C. Archived manuscripts can seldom be accessed without clearance.",
      "D. Archived manuscripts are seldom able to be accessed without clearance."
    ]
  },
  {
    "id": 88,
    "q": "Select the sentence containing the homonym of the highlighted word:\nThe prince’s gules dominated the family coat of arms.",
    "options": [
      "A. The tapestry featured gules and argent prominently.",
      "B. The chef prepared a sauce of deep gules and cumin.",
      "C. The gules border signified martial lineage.",
      "D. The herald explained the symbolism of gules to visitors."
    ]
  },
  {
    "id": 89,
    "q": "Convert the sentence provided below from its passive voice structure to an active voice structure:\nThe package is delivered to the office every morning.",
    "options": [
      "A. The office delivers the package every morning.",
      "B. Someone delivers the package to the office every morning.",
      "C. The office has delivered the package every morning.",
      "D. The package delivers itself to the office every morning."
    ]
  },
  {
    "id": 90,
    "q": "Read the following passage and answer the questions based on the passage :\n\nThe proliferation of social media has fundamentally transformed the democratic landscape, acting both as a catalyst for civic engagement and a conduit for manipulation. Platforms like Twitter, Facebook, and Instagram, once relegated to the domain of personal expression, now serve as powerful instruments of political discourse, enabling citizens to articulate opinions, mobilize for causes, and scrutinize authority in real-time. At its core, democracy thrives on the free flow of information, and social media ostensibly democratizes this process by dismantling traditional gatekeeping. Political leaders communicate directly with constituents, bypassing editorial filters, while grassroots movements harness virality to amplify marginalized voices. During critical events—be it elections, protests, or legislative debates—social media acts as a digital agora, fostering participatory dialogue that was once confined to town halls or print columns. However, this unprecedented openness is double-edged. The same platforms that disseminate truth can also propagate misinformation, polarize public opinion, and algorithmically reinforce ideological silos. Electoral interference through fake accounts, coordinated trolling, and the spread of disinformation campaigns have threatened electoral integrity in several democracies. Moreover, emotionally charged content, optimized for engagement rather than accuracy, often eclipses nuanced debate, reducing political discourse to a cacophony of outrage. The role of social media in democracy, therefore, is contingent not just on its technological architecture, but on the ethical frameworks governing its use. Regulatory oversight, media literacy, and algorithmic transparency are essential to harness its democratic potential while mitigating its subversive tendencies. In essence, social media is neither inherently virtuous nor inherently corrosive—it is a mirror of societal intent. Whether it becomes a pillar of democratic resilience or a tool of populist distortion depends largely on how it is wielded by citizens, institutions, and platforms alike.\n\nWhat primary democratic function does social media serve, as per the paragraph?",
    "options": [
      "A. Promoting entertainment",
      "B. Replacing newspapers",
      "C. Facilitating free flow of information",
      "D. Organizing trade unions"
    ]
  },
  {
    "id": 91,
    "q": "Read the following passage and answer the questions based on the passage :\n\nThe proliferation of social media has fundamentally transformed the democratic landscape, acting both as a catalyst for civic engagement and a conduit for manipulation. Platforms like Twitter, Facebook, and Instagram, once relegated to the domain of personal expression, now serve as powerful instruments of political discourse, enabling citizens to articulate opinions, mobilize for causes, and scrutinize authority in real-time. At its core, democracy thrives on the free flow of information, and social media ostensibly democratizes this process by dismantling traditional gatekeeping. Political leaders communicate directly with constituents, bypassing editorial filters, while grassroots movements harness virality to amplify marginalized voices. During critical events—be it elections, protests, or legislative debates—social media acts as a digital agora, fostering participatory dialogue that was once confined to town halls or print columns. However, this unprecedented openness is double-edged. The same platforms that disseminate truth can also propagate misinformation, polarize public opinion, and algorithmically reinforce ideological silos. Electoral interference through fake accounts, coordinated trolling, and the spread of disinformation campaigns have threatened electoral integrity in several democracies. Moreover, emotionally charged content, optimized for engagement rather than accuracy, often eclipses nuanced debate, reducing political discourse to a cacophony of outrage. The role of social media in democracy, therefore, is contingent not just on its technological architecture, but on the ethical frameworks governing its use. Regulatory oversight, media literacy, and algorithmic transparency are essential to harness its democratic potential while mitigating its subversive tendencies. In essence, social media is neither inherently virtuous nor inherently corrosive—it is a mirror of societal intent. Whether it becomes a pillar of democratic resilience or a tool of populist distortion depends largely on how it is wielded by citizens, institutions, and platforms alike.\n\nWhat makes social media a double-edged tool in democratic societies?",
    "options": [
      "A. Its affordability",
      "B. Its visual design",
      "C. Its ability to spread both truth and misinformation",
      "D. Its international reach"
    ]
  },
  {
    "id": 92,
    "q": "Read the following passage and answer the questions based on the passage :\n\nThe proliferation of social media has fundamentally transformed the democratic landscape, acting both as a catalyst for civic engagement and a conduit for manipulation. Platforms like Twitter, Facebook, and Instagram, once relegated to the domain of personal expression, now serve as powerful instruments of political discourse, enabling citizens to articulate opinions, mobilize for causes, and scrutinize authority in real-time. At its core, democracy thrives on the free flow of information, and social media ostensibly democratizes this process by dismantling traditional gatekeeping. Political leaders communicate directly with constituents, bypassing editorial filters, while grassroots movements harness virality to amplify marginalized voices. During critical events—be it elections, protests, or legislative debates—social media acts as a digital agora, fostering participatory dialogue that was once confined to town halls or print columns. However, this unprecedented openness is double-edged. The same platforms that disseminate truth can also propagate misinformation, polarize public opinion, and algorithmically reinforce ideological silos. Electoral interference through fake accounts, coordinated trolling, and the spread of disinformation campaigns have threatened electoral integrity in several democracies. Moreover, emotionally charged content, optimized for engagement rather than accuracy, often eclipses nuanced debate, reducing political discourse to a cacophony of outrage. The role of social media in democracy, therefore, is contingent not just on its technological architecture, but on the ethical frameworks governing its use. Regulatory oversight, media literacy, and algorithmic transparency are essential to harness its democratic potential while mitigating its subversive tendencies. In essence, social media is neither inherently virtuous nor inherently corrosive—it is a mirror of societal intent. Whether it becomes a pillar of democratic resilience or a tool of populist distortion depends largely on how it is wielded by citizens, institutions, and platforms alike.\n\nAccording to the paragraph, which element amplifies marginalized voices through social media?",
    "options": [
      "A. Editorial boards",
      "B. Gatekeeping journalism",
      "C. viral reach and grassroots mobilization",
      "D. Institutional press"
    ]
  },
  {
    "id": 93,
    "q": "Read the following passage and answer the questions based on the passage :\n\nThe proliferation of social media has fundamentally transformed the democratic landscape, acting both as a catalyst for civic engagement and a conduit for manipulation. Platforms like Twitter, Facebook, and Instagram, once relegated to the domain of personal expression, now serve as powerful instruments of political discourse, enabling citizens to articulate opinions, mobilize for causes, and scrutinize authority in real-time. At its core, democracy thrives on the free flow of information, and social media ostensibly democratizes this process by dismantling traditional gatekeeping. Political leaders communicate directly with constituents, bypassing editorial filters, while grassroots movements harness virality to amplify marginalized voices. During critical events—be it elections, protests, or legislative debates—social media acts as a digital agora, fostering participatory dialogue that was once confined to town halls or print columns. However, this unprecedented openness is double-edged. The same platforms that disseminate truth can also propagate misinformation, polarize public opinion, and algorithmically reinforce ideological silos. Electoral interference through fake accounts, coordinated trolling, and the spread of disinformation campaigns have threatened electoral integrity in several democracies. Moreover, emotionally charged content, optimized for engagement rather than accuracy, often eclipses nuanced debate, reducing political discourse to a cacophony of outrage. The role of social media in democracy, therefore, is contingent not just on its technological architecture, but on the ethical frameworks governing its use. Regulatory oversight, media literacy, and algorithmic transparency are essential to harness its democratic potential while mitigating its subversive tendencies. In essence, social media is neither inherently virtuous nor inherently corrosive—it is a mirror of societal intent. Whether it becomes a pillar of democratic resilience or a tool of populist distortion depends largely on how it is wielded by citizens, institutions, and platforms alike.\n\nWhat does the author suggest as a critical solution to social media misuse in democracies?",
    "options": [
      "A. Enhanced meme culture",
      "B. Legalizing all content",
      "C. Algorithmic transparency and media literacy",
      "D. Global censorship policies"
    ]
  },
  {
    "id": 94,
    "q": "Read the following passage and answer the questions based on the passage :\n\nThe proliferation of social media has fundamentally transformed the democratic landscape, acting both as a catalyst for civic engagement and a conduit for manipulation. Platforms like Twitter, Facebook, and Instagram, once relegated to the domain of personal expression, now serve as powerful instruments of political discourse, enabling citizens to articulate opinions, mobilize for causes, and scrutinize authority in real-time. At its core, democracy thrives on the free flow of information, and social media ostensibly democratizes this process by dismantling traditional gatekeeping. Political leaders communicate directly with constituents, bypassing editorial filters, while grassroots movements harness virality to amplify marginalized voices. During critical events—be it elections, protests, or legislative debates—social media acts as a digital agora, fostering participatory dialogue that was once confined to town halls or print columns. However, this unprecedented openness is double-edged. The same platforms that disseminate truth can also propagate misinformation, polarize public opinion, and algorithmically reinforce ideological silos. Electoral interference through fake accounts, coordinated trolling, and the spread of disinformation campaigns have threatened electoral integrity in several democracies. Moreover, emotionally charged content, optimized for engagement rather than accuracy, often eclipses nuanced debate, reducing political discourse to a cacophony of outrage. The role of social media in democracy, therefore, is contingent not just on its technological architecture, but on the ethical frameworks governing its use. Regulatory oversight, media literacy, and algorithmic transparency are essential to harness its democratic potential while mitigating its subversive tendencies. In essence, social media is neither inherently virtuous nor inherently corrosive—it is a mirror of societal intent. Whether it becomes a pillar of democratic resilience or a tool of populist distortion depends largely on how it is wielded by citizens, institutions, and platforms alike.\n\nIn the author's view, what determines whether social media supports or undermines democracy?",
    "options": [
      "A. Political advertisements",
      "B. How platforms are funded",
      "C. Societal intent and ethical usage",
      "D. Popularity of influencers"
    ]
  },
  {
    "id": 95,
    "q": "Choose the most suitable option to replace the highlighted part of the sentence:\nNo sooner had I reached the station when the train departed.",
    "options": [
      "A. - than the train departed",
      "B. then the train departed",
      "C. when the train had departed",
      "D. - than did the train depart"
    ]
  },
  {
    "id": 96,
    "q": "Choose the most suitable option to replace the highlighted part of the sentence:\nThe manager asked to the clerk to submit the report.",
    "options": [
      "A. asked the clerk that submit the report",
      "B. requested the clerk to submit report",
      "C. asked the clerk to submit the report",
      "D. told to the clerk submit report"
    ]
  },
  {
    "id": 97,
    "q": "A sentence is provided in direct speech. From the four given options, choose the one that most accurately conveys the sentence in its corresponding indirect speech.\nShe said, “I saw him last night.”",
    "options": [
      "A. She said she had seen him the previous night.",
      "B. She said she has seen him last night.",
      "C. She said she was seeing him last night.",
      "D. She said she had saw him the previous night."
    ]
  },
  {
    "id": 98,
    "q": "A sentence is provided in indirect speech. From the four given options, choose the one that most accurately conveys the sentence in its corresponding direct speech.\nThe librarian said that silence must be maintained in the library.",
    "options": [
      "A. \"Silence should be maintained in the library,\" said the librarian.",
      "B. \"You will maintain silence in the library,\" the librarian said.",
      "C. \"Maintain silence in the library,\" said the librarian.",
      "D. \"Must you maintain silence in the library?\" asked the librarian."
    ]
  },
  {
    "id": 99,
    "q": "Rearrange the following sentences to form a coherent paragraph:\n1. Consequently, effective communication hinges on more than just the words we choose. 2. Non-verbal cues, such as tone of voice, facial expressions, and body language, can convey more meaning than the verbal message itself. 3. Communication is a complex process involving the exchange of information, ideas, and feelings between individuals. 4. It's often the subtle signals that tell us how a message is truly being received or intended.",
    "options": [
      "A. 3, 2, 1, 4",
      "B. 2, 4, 1, 3",
      "C. 1, 4, 3, 2",
      "D. 3, 4, 2, 1"
    ]
  },
  {
    "id": 100,
    "q": "Rearrange the following sentences to form a coherent paragraph:\n1. A key strategy is to diversify energy sources, transitioning from fossil fuels to renewable alternatives like solar, wind, and geothermal power. 2. To mitigate the worst effects of climate change, the global community must drastically reduce its reliance on carbon-intensive energy production. 3. This shift not only decreases greenhouse gas emissions but also improves air quality and creates new economic opportunities. 4. Additionally, policies that promote energy efficiency in buildings and transportation can further lower overall energy consumption.",
    "options": [
      "A. 2, 1, 3, 4",
      "B. 1, 2, 4, 3",
      "C. 3, 4, 1, 2",
      "D. 4, 3, 2, 1"
    ]
  }
];

/* ---------- State ---------- */
const STATE_KEY = 'ssc_shift2_state_v1';

let state = {
  currentSectionIndex: 0, // 0-3
  currentQuestionIndex: 0,
  answers: {},            // key: "id" -> option letter ("A"/"B"/"C"/"D")
  marked: {},             // id -> true
  skipped: {},            // id -> true
  timerSeconds: 60*60,    // 60 minutes
  running: false,
  paused: false,
  submitted: false,
  sectionTimes: { A:0, B:0, C:0, D:0 }, // seconds
  sectionActiveStart: null // timestamp when section became active (for accumulating)
};

/* ---------- Helpers ---------- */
const el = id => document.getElementById(id);
const formatTime = s => {
  if(s < 0) s = 0;
  const mm = String(Math.floor(s/60)).padStart(2,'0');
  const ss = String(s%60).padStart(2,'0');
  return `${mm}:${ss}`;
};
const secToHMS = s => {
  const hh = Math.floor(s/3600); const mm = Math.floor((s%3600)/60); const ss = s%60;
  return `${String(hh).padStart(2,'0')}:${String(mm).padStart(2,'0')}:${String(ss).padStart(2,'0')}`;
};
const saveState = () => localStorage.setItem(STATE_KEY, JSON.stringify(state));
const loadState = () => {
  const raw = localStorage.getItem(STATE_KEY);
  if(raw) {
    try { Object.assign(state, JSON.parse(raw)); } catch(e){ console.warn('load failed',e); }
  }
};

/* ---------- Timer ---------- */
let timerInterval = null;
function startGlobalTimer(){
  if(timerInterval) clearInterval(timerInterval);
  state.running = true;
  timerInterval = setInterval(()=>{
    if(state.paused || !state.running) return;
    state.timerSeconds--;
    // accumulate section active time if a section is active
    if(state.sectionActiveStart) {
      // we accumulate when switching sections, not every tick to avoid heavy writes; but keep state up to date
    }
    if(state.timerSeconds <= 0){
      clearInterval(timerInterval);
      state.timerSeconds = 0;
      doSubmit();
    }
    renderTime();
    saveState();
  }, 1000);
}
function stopGlobalTimer(){
  if(timerInterval) clearInterval(timerInterval);
  state.running = false;
}

/* ---------- UI init ---------- */

function buildSectionButtons(){
  const wrap = el('sectionList'); wrap.innerHTML = '';
  SECTIONS.forEach((sec, idx) => {
    const b = document.createElement('button');
    b.className = 'section-btn' + (idx === state.currentSectionIndex ? ' active' : '');
    b.innerText = `${sec.name} (${sec.items.length})`;
    b.onclick = () => switchSection(idx);
    wrap.appendChild(b);
  });
}

function buildGrid(){
  const wrap = el('qGrid'); wrap.innerHTML = '';
  const sec = SECTIONS[state.currentSectionIndex];
  sec.items.forEach((q, idx) => {
    const key = String(q.id);
    const btn = document.createElement('button');
    btn.className = 'qnum';
    if(state.marked[key]) btn.classList.add('marked');
    else if(state.skipped[key]) btn.classList.add('skipped');
    else if(state.answers[key]) btn.classList.add('answered');
    btn.innerText = idx + 1;
    btn.title = `Q${q.id}`;
    btn.onclick = () => { state.currentQuestionIndex = idx; renderQuestion(); };
    wrap.appendChild(btn);
  });
  updateSectionSummary();
}

function updateSectionSummary(){
  const sec = SECTIONS[state.currentSectionIndex];
  const answered = sec.items.reduce((a,q)=> a + (state.answers[String(q.id)]?1:0),0);
  el('secAnswered').innerText = answered;
  el('secNotAnswered').innerText = sec.items.length - answered;
}

function updateTotals(){
  const total = Object.keys(state.answers).length;
  el('totalAnswered').innerText = total;
  el('footerAnswered').innerText = total;
}

/* ---------- Render question ---------- */
function renderQuestion(reviewMode=false){
  const sec = SECTIONS[state.currentSectionIndex];
  if(!sec) return;
  const q = sec.items[state.currentQuestionIndex];
  el('qHeader').innerText = `Section: ${sec.name} — Q${q.id}`;
  el('qText').innerHTML = q.q.replace(/\n/g,'<br>');
  const optsWrap = el('optsWrap'); optsWrap.innerHTML = '';
  const key = String(q.id);
  const letters = ['A','B','C','D'];
  q.options.forEach((optText, i) => {
    const letter = letters[i] || String.fromCharCode(65+i);
    const lab = document.createElement('label');
    lab.className = 'opt';
    const radio = document.createElement('input');
    radio.type = 'radio'; radio.name = 'optRadio';
    radio.disabled = state.paused || state.submitted;
    radio.checked = state.answers[key] === letter;
    radio.onchange = () => {
      if(state.paused || state.submitted) return;
      state.answers[key] = letter;
      state.skipped[key] = false;
      saveState(); buildGrid(); updateTotals();
    };
    const txt = document.createElement('span'); txt.innerText = `${letter}. ${optText}`;
    lab.appendChild(radio); lab.appendChild(txt);

    // click on whole label selects
    lab.onclick = (e) => {
      if(state.paused || state.submitted) return;
      state.answers[key] = letter;
      state.skipped[key] = false;
      saveState(); buildGrid(); updateTotals();
      radio.checked = true;
    };

    // review highlighting
    if(state.submitted){
      const correct = ANSWER_KEY[key];
      if(correct === letter) lab.classList.add('correct');
      if(state.answers[key] && state.answers[key] === letter && state.answers[key] !== correct) lab.classList.add('wrong');
      // disable interactions
      radio.disabled = true;
    }

    if(state.paused){ lab.classList.add('disabled'); radio.disabled = true; }

    optsWrap.appendChild(lab);
  });
  updateTotals();
  buildGrid();
  updateSectionSummary();
}

/* ---------- Navigation ---------- */
function saveAndNext(){
  const sec = SECTIONS[state.currentSectionIndex];
  const q = sec.items[state.currentQuestionIndex];
  const key = String(q.id);
  if(!state.answers[key]) state.skipped[key] = true;
  else state.skipped[key] = false;
  if(state.currentQuestionIndex < sec.items.length - 1) state.currentQuestionIndex++;
  else if(state.currentSectionIndex < SECTIONS.length - 1){
    switchSection(state.currentSectionIndex + 1);
    state.currentQuestionIndex = 0;
  }
  renderQuestion();
  saveState();
}

function goPrev(){
  if(state.currentQuestionIndex > 0){ state.currentQuestionIndex--; renderQuestion(); return; }
  if(state.currentSectionIndex > 0){
    switchSection(state.currentSectionIndex - 1);
    state.currentQuestionIndex = SECTIONS[state.currentSectionIndex].items.length - 1;
    renderQuestion();
  }
}

function clearResponse(){
  const sec = SECTIONS[state.currentSectionIndex];
  const q = sec.items[state.currentQuestionIndex];
  const key = String(q.id);
  delete state.answers[key];
  state.skipped[key] = true;
  saveState(); buildGrid(); updateTotals(); renderQuestion();
}

function markForReview(){
  const sec = SECTIONS[state.currentSectionIndex];
  const q = sec.items[state.currentQuestionIndex];
  const key = String(q.id);
  state.marked[key] = true;
  // move next
  saveAndNext();
  saveState();
}

/* ---------- Section switch & per-section time tracking ---------- */
function switchSection(newIndex){
  if(newIndex === state.currentSectionIndex) return;
  // accumulate time for current active section
  accumulateSectionTime();
  // change current section
  state.currentSectionIndex = newIndex;
  // reset question index if out of bounds
  state.currentQuestionIndex = 0;
  // set new section active start if running and not paused
  if(!state.paused && state.running){
    state.sectionActiveStart = Date.now();
  } else {
    state.sectionActiveStart = null;
  }
  buildSectionButtons();
  buildGrid();
  renderQuestion();
  saveState();
}

function accumulateSectionTime(){
  const idx = state.currentSectionIndex;
  const secKey = SECTIONS[idx].key;
  if(state.sectionActiveStart){
    const elapsed = Math.floor((Date.now() - state.sectionActiveStart)/1000);
    if(!isNaN(elapsed) && elapsed > 0) {
      state.sectionTimes[secKey] = (state.sectionTimes[secKey] || 0) + elapsed;
    }
    state.sectionActiveStart = null;
  }
}

/* ---------- Pause / Resume ---------- */
function setPaused(on){
  state.paused = on;
  el('pauseBtn').innerText = on ? 'Resume' : 'Pause';
  // show badge
  el('pausedBadge').style.display = on ? 'block' : 'none';
  // when pausing, stop accumulating section active time
  if(on){
    // accumulate current active
    accumulateSectionTime();
  } else {
    // resume section active timing
    if(state.running){
      state.sectionActiveStart = Date.now();
    }
  }
  renderQuestion();
  saveState();
}

/* ---------- Fullscreen ---------- */
async function toggleFullscreen(){
  try{
    if(!document.fullscreenElement){
      await document.documentElement.requestFullscreen();
      el('fsBtn').innerText = 'Exit full-screen';
    } else {
      await document.exitFullscreen();
      el('fsBtn').innerText = 'Full screen';
    }
  }catch(e){ console.warn('fs',e); }
}

/* ---------- Submit / Scoring ---------- */
function doSubmit(){
  if(state.submitted) return;
  // finalize timers
  accumulateSectionTime();
  // stop timer
  stopGlobalTimer();
  state.submitted = true;
  // compute score
  const result = computeResults();
  // show result area and review
  showResults(result);
  saveState();
}

function computeResults(){
  let totalCorrect = 0, totalAttempted = 0;
  const perSection = {};
  SECTIONS.forEach(sec=>{
    const key = sec.key;
    perSection[key] = { correct:0, attempted:0, total: sec.items.length, time: state.sectionTimes[key] || 0 };
    sec.items.forEach(q=>{
      const ans = state.answers[String(q.id)];
      if(ans) perSection[key].attempted++;
      if(ans && ANSWER_KEY[String(q.id)] === ans) perSection[key].correct++;
    });
    totalCorrect += perSection[key].correct;
    totalAttempted += perSection[key].attempted;
  });
  const totalMarks = totalCorrect; // simple 1 mark per correct — change if needed
  const totalQuestions = SECTIONS.reduce((a,s)=>a+s.items.length,0);
  return { perSection, totalCorrect, totalAttempted, totalMarks, totalQuestions };
}

function showResults(result){
  el('resultsArea').style.display = 'block';
  // build markcard summary
  const container = el('markcardSummary');
  container.innerHTML = '';
  const table = document.createElement('table');
  const thead = document.createElement('thead');
  thead.innerHTML = `<tr><th>Section</th><th>Total Qs</th><th>Attempted</th><th>Correct</th><th>Wrong</th><th>Time Spent</th></tr>`;
  const tbody = document.createElement('tbody');
  for(const sec of SECTIONS){
    const info = result.perSection[sec.key];
    const wrong = info.attempted - info.correct;
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${sec.name}</td><td>${info.total}</td><td>${info.attempted}</td><td>${info.correct}</td><td>${wrong}</td><td>${secToHMS(info.time)}</td>`;
    tbody.appendChild(tr);
  }
  const totalRow = document.createElement('tr');
  totalRow.innerHTML = `<th>Total</th><th>${result.totalQuestions}</th><th>${result.totalAttempted}</th><th>${result.totalCorrect}</th><th>${result.totalAttempted - result.totalCorrect}</th><th>-</th>`;
  tbody.appendChild(totalRow);
  table.appendChild(thead); table.appendChild(tbody);
  container.appendChild(table);

  // build review tabs
  const reviewTabs = el('reviewTabs'); reviewTabs.innerHTML = '';
  SECTIONS.forEach((sec, idx)=>{
    const b = document.createElement('div');
    b.className = 'tab' + (idx===0?' active':'');
    b.innerText = `${sec.name}`;
    b.onclick = () => {
      // set active
      Array.from(reviewTabs.children).forEach(c=>c.classList.remove('active'));
      b.classList.add('active');
      renderReviewSection(idx);
    };
    reviewTabs.appendChild(b);
  });

  // initial content
  renderReviewSection(0);
  // show view markcard button visible
  el('viewMarkcardBtn').style.display = 'inline-block';
}

/* ---------- Review rendering ---------- */
function renderReviewSection(secIndex){
  const content = el('reviewContent'); content.innerHTML = '';
  const sec = SECTIONS[secIndex];
  // list question tiles with status right/wrong
  const listWrap = document.createElement('div');
  listWrap.className = 'review-list';
  sec.items.forEach((q, idx) => {
    const id = String(q.id);
    const div = document.createElement('div');
    div.className = 'rev-q';
    const ans = state.answers[id];
    const correct = ANSWER_KEY[id];
    const status = (!ans) ? 'Unattempted' : (ans === correct ? 'Correct' : 'Wrong');
    div.innerHTML = `<div style="font-weight:800">Q${q.id}</div><div style="font-size:12px;color:#666;margin-top:6px">${status}</div>`;
    if(status === 'Correct') div.style.background = '#e9f7ef';
    if(status === 'Wrong') div.style.background = '#fff3f3';
    div.onclick = () => {
      // show this question in review display below
      renderReviewQuestion(secIndex, idx);
    };
    listWrap.appendChild(div);
  });
  content.appendChild(listWrap);
  // show first question by default
  renderReviewQuestion(secIndex, 0);
}

function renderReviewQuestion(secIndex, qIndex){
  const sec = SECTIONS[secIndex];
  const q = sec.items[qIndex];
  const content = el('reviewContent');
  // create detail view
  const detail = document.createElement('div');
  detail.style.marginTop = '12px';
  detail.style.background = '#fff';
  detail.style.padding = '12px';
  detail.style.borderRadius = '8px';
  detail.style.border = '1px solid #e6eef8';
  detail.innerHTML = `<div style="font-weight:800;margin-bottom:8px">${sec.name} — Q${q.id}</div><div style="margin-bottom:10px">${q.q.replace(/\n/g,'<br>')}</div>`;
  // options with highlighting
  const letters = ['A','B','C','D'];
  const ul = document.createElement('div');
  q.options.forEach((opt, i)=>{
    const letter = letters[i];
    const optDiv = document.createElement('div');
    optDiv.style.padding='8px'; optDiv.style.borderRadius='6px'; optDiv.style.marginBottom='6px'; optDiv.style.border='1px solid #eef6ff';
    const correct = ANSWER_KEY[String(q.id)];
    if(letter === correct) optDiv.style.background = 'var(--correct)';
    if(state.answers[String(q.id)] === letter && state.answers[String(q.id)] !== correct) optDiv.style.background = 'var(--wrong)';
    optDiv.innerText = `${letter}. ${opt}`;
    detail.appendChild(optDiv);
  });
  // show your choice and correct
  const your = state.answers[String(q.id)] || 'Unattempted';
  const correct = ANSWER_KEY[String(q.id)];
  const footer = document.createElement('div');
  footer.style.marginTop='10px';
  footer.innerHTML = `<strong>Your answer:</strong> ${your} &nbsp;&nbsp; <strong>Correct:</strong> ${correct}`;
  detail.appendChild(footer);
  // add button to view markcard
  const btnWrap = document.createElement('div'); btnWrap.style.marginTop='12px';
  const viewMark = document.createElement('button'); viewMark.className='btn'; viewMark.innerText='View Markcard';
  viewMark.onclick = () => {
    // scroll to markcard summary
    window.scrollTo({top:0,behavior:'smooth'});
  };
  btnWrap.appendChild(viewMark);
  detail.appendChild(btnWrap);

  // replace old detailed area
  // keep the list, append detail after it
  // remove any existing detail nodes
  // find listWrap and append
  const listWrap = content.querySelector('.review-list');
  // remove any existing detail nodes after listWrap
  while(listWrap.nextSibling) listWrap.parentNode.removeChild(listWrap.nextSibling);
  listWrap.parentNode.appendChild(detail);
}

/* ---------- Restart ---------- */
function restartExam(){
  if(!confirm('Restart exam? This will clear all saved progress.')) return;
  // clear localStorage and reset state
  localStorage.removeItem(STATE_KEY);
  location.reload();
}

/* ---------- Persistence load ---------- */
function initFromStorage(){
  loadState();
  // if submitted in storage, show results immediately
  buildSectionButtons();
  buildGrid();
  renderQuestion();
  renderTime();
  updateTotals();
  if(state.submitted){
    startGlobalTimer(); // not running but maintain functions
    stopGlobalTimer();
    const res = computeResults();
    showResults(res);
  } else {
    // resume timer if running
    if(state.running && !state.paused){
      // set sectionActiveStart to now to resume accumulation
      state.sectionActiveStart = Date.now();
      startGlobalTimer();
    } else {
      renderTime();
    }
  }
}

/* ---------- Render time ---------- */
function renderTime(){
  el('timeBox').innerText = formatTime(state.timerSeconds);
}

/* ---------- Start exam flow ---------- */
async function onStartClick(){
  // enter fullscreen
  try{
    if(!document.fullscreenElement) await document.documentElement.requestFullscreen();
  }catch(e){ console.warn('fs failed', e); }
  // initialize state
  state.timerSeconds = 60 * 60; // 60 minutes
  state.running = true;
  state.paused = false;
  state.submitted = false;
  state.answers = {};
  state.marked = {};
  state.skipped = {};
  state.sectionTimes = { A:0, B:0, C:0, D:0 };
  state.sectionActiveStart = Date.now();
  state.currentSectionIndex = 0;
  state.currentQuestionIndex = 0;
  saveState();
  el('startOverlay').style.display = 'none';
  buildSectionButtons();
  buildGrid();
  renderQuestion();
  startGlobalTimer();
}

/* ---------- Event bindings ---------- */
document.addEventListener('DOMContentLoaded', ()=>{
  // wire buttons
  el('startBtn').onclick = onStartClick;
  el('fsBtn').onclick = toggleFullscreen;
  el('pauseBtn').onclick = () => {
    setPaused(!state.paused);
    saveState();
  };
  el('restartBtn').onclick = restartExam;
  el('saveNextBtn').onclick = () => { saveAndNext(); };
  el('prevBtn').onclick = goPrev;
  el('clearBtn').onclick = clearResponse;
  el('markBtn').onclick = markForReview;
  el('submitTop').onclick = () => {
    if(!confirm('Submit exam now?')) return;
    doSubmit();
  };
  el('viewMarkcardBtn').onclick = () => {
    // scroll to markcard summary
    window.scrollTo({top:0,behavior:'smooth'});
  };
  el('backToExamBtn').onclick = () => {
    // hide results area and show exam UI (scroll)
    el('resultsArea').style.display = 'none';
    // allow navigating back to exam UI: if exam not submitted, allow
    // If exam submitted and user wants to revisit exam screen, we still keep submitted true and review UI will be read-only
    window.scrollTo({top:0,behavior:'smooth'});
  };

  // reviewAnswersBtn (hidden during exam) — show after submit
  el('reviewAnswersBtn').onclick = () => {
    const res = computeResults();
    showResults(res);
    el('resultsArea').scrollIntoView({behavior:'smooth'});
  };

  // handle visibility change: if user switches tab, pause accumulation & timer continues but we track sectionActiveStart properly
  document.addEventListener('visibilitychange', () => {
    if(document.hidden){
      // accumulate current section time chunk
      accumulateSectionTime();
    } else {
      if(!state.paused && state.running){
        state.sectionActiveStart = Date.now();
      }
    }
  });

  // load saved state if present
  initFromStorage();
});

/* Save state periodically */
setInterval(()=>saveState(), 5000);

</script>
</body>
</html>


