<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>SSC CGL — 12 Sep Shift 2 (Mock)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --blue:#153d7a;
      --accent:#1f4d8a;
      --green:#28a745;
      --red:#d9534f;
      --marked:#7b3fb0;
      --muted:#6b7280;
      --card:#ffffff;
      --bg:#f3f6fb;
      --correct:#dff5e0;
      --wrong:#fff0f0;
      --highlight:#e8f2ff;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:var(--bg);color:#17202a}
    .topbar{background:linear-gradient(90deg,var(--blue),#2b62b0);color:#fff;padding:12px 18px;display:flex;align-items:center;justify-content:space-between;position:relative}
    .brand{display:flex;align-items:center;gap:12px}
    .brand .logo{width:44px;height:44px;border-radius:8px;background:#fff;color:var(--blue);display:flex;align-items:center;justify-content:center;font-weight:900}
    .brand h1{margin:0;font-size:18px;letter-spacing:0.2px}
    .controls{display:flex;gap:10px;align-items:center}
    .btn{background:var(--accent);color:#fff;border:0;padding:8px 12px;border-radius:6px;cursor:pointer;font-weight:700}
    .btn.ghost{background:#fff;color:var(--accent);border:1px solid #dfe7f3}
    .timer{font-weight:800;background:#ffdede;color:#b30000;padding:6px 10px;border-radius:6px}
    .layout{display:flex;gap:16px;padding:16px;height:calc(100vh - 72px);align-items:flex-start}
    /* left panel */
    .left{width:320px;background:var(--card);border-radius:10px;padding:14px;box-shadow:0 6px 18px rgba(16,24,40,0.06);display:flex;flex-direction:column;gap:12px;overflow:auto}
    .sections{display:flex;flex-direction:column;gap:8px}
    .section-btn{background:var(--accent);color:#fff;border:0;padding:8px;border-radius:6px;text-align:left;cursor:pointer;font-weight:800}
    .section-btn.active{background:var(--green)}
    .qgrid{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .qnum{width:44px;height:38px;border-radius:6px;display:flex;align-items:center;justify-content:center;font-weight:800;background:var(--accent);color:#fff;cursor:pointer;border:0}
    .qnum.answered{background:var(--green)}
    .qnum.skipped{background:var(--red)}
    .qnum.marked{background:var(--marked)}
    .summary{margin-top:auto;background:#f6f9ff;padding:10px;border-radius:8px;color:var(--muted);font-weight:700}
    /* main area */
    .main{flex:1;display:flex;flex-direction:column;height:100%}
    .controls-row{background:var(--card);padding:12px;border-radius:10px;display:flex;gap:8px;align-items:center;box-shadow:0 6px 18px rgba(16,24,40,0.04)}
    .qcard{flex:1;background:var(--card);margin-top:12px;border-radius:10px;padding:18px;box-shadow:0 6px 18px rgba(16,24,40,0.04);overflow:auto;min-height:300px}
    .qheader{font-weight:800;margin-bottom:12px}
    .qtext{font-size:15px;line-height:1.6}
    .options{margin-top:12px;display:flex;flex-direction:column;gap:10px}
    .opt{border:1px solid #e8eef8;padding:12px;border-radius:8px;display:flex;gap:10px;align-items:center;cursor:pointer;background:#fff}
    .opt.disabled{opacity:0.6;pointer-events:none}
    .opt.correct{background:var(--correct);border-color:rgba(40,162,69,0.25)}
    .opt.wrong{background:var(--wrong);border-color:rgba(217,83,79,0.2)}
    .opt input{transform:scale(1.0);margin-right:8px}
    .footer{display:flex;justify-content:space-between;align-items:center;margin-top:12px;padding:10px 4px}
    .small{color:var(--muted);font-weight:700}
    /* results & review */
    #resultsArea{display:none;padding:18px}
    .results{padding:20px;background:var(--card);border-radius:10px;box-shadow:0 6px 18px rgba(16,24,40,0.04)}
    table{border-collapse:collapse;width:100%}
    th,td{border:1px solid #e9eef8;padding:10px;text-align:left}
    .overlay{
      position:fixed;inset:0;background:rgba(10,10,10,0.45);display:flex;align-items:center;justify-content:center;z-index:50;
    }
    .start-card{background:#fff;padding:36px;border-radius:12px;box-shadow:0 10px 40px rgba(16,24,40,0.3);text-align:center}
    .start-card h1{margin:0 0 12px 0;font-size:28px}
    .start-card p{color:#666;margin:6px 0 18px}
    .small-muted{font-size:12px;color:#6b7280}
    .paused-badge{position:fixed;top:84px;right:26px;background:rgba(0,0,0,0.6);color:#fff;padding:8px 12px;border-radius:8px;font-weight:800;display:none;z-index:60}
    .review-tabs{display:flex;gap:8px;margin-bottom:12px}
    .tab{padding:8px 10px;border-radius:8px;background:#f3f6fb;cursor:pointer;font-weight:800}
    .tab.active{background:var(--accent);color:#fff}
    .review-list{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
    .rev-q{padding:8px;border-radius:6px;background:#fff;border:1px solid #e6eef8;cursor:pointer;text-align:center}
    /* responsive */
    @media(max-width:980px){
      .layout{flex-direction:column;height:auto}
      .left{width:100%;display:flex;order:2}
      .main{order:1}
    }
  </style>
</head>
<body>

  <div class="topbar">
    <div class="brand">
      <div class="logo">SSC</div>
      <div>
        <h1 id="examTitle">SSC CGL — 12 Sep Shift 2</h1>
        <div style="font-size:12px;color:rgba(255,255,255,0.9)">Full Mock — 60 minutes · Single-question view</div>
      </div>
    </div>

    <div class="controls">
      <div style="text-align:right">
        <div class="small" style="color:#fff">Total Answered: <span id="totalAnswered">0</span></div>
        <div style="margin-top:6px;display:flex;gap:8px;align-items:center">
          <div class="timer" id="timeBox">60:00</div>
          <button id="fsBtn" class="btn ghost" title="Toggle Fullscreen">Full screen</button>
        </div>
      </div>
      <button id="submitTop" class="btn" title="Submit exam">Submit</button>
    </div>
  </div>

  <div class="layout">
    <!-- LEFT PANEL -->
    <aside class="left">
      <div style="display:flex;align-items:center;gap:10px">
        <div style="font-weight:800;font-size:16px;color:var(--blue)">Sections</div>
      </div>

      <div class="sections" id="sectionList">
        <!-- JS populates sections -->
      </div>

      <div style="font-weight:800;color:var(--blue);margin-top:6px">Question Panel</div>
      <div class="qgrid" id="qGrid"><!-- populated by JS --></div>

      <div class="summary">
        <div>Section Summary</div>
        <div style="margin-top:8px">Answered: <span id="secAnswered">0</span></div>
        <div>Not Answered: <span id="secNotAnswered">0</span></div>
      </div>
    </aside>

    <!-- MAIN AREA -->
    <main class="main">
      <div class="controls-row">
        <button id="prevBtn" class="btn ghost">Previous</button>
        <button id="clearBtn" class="btn ghost">Clear Response</button>
        <button id="markBtn" class="btn ghost" style="background:#fff;color:var(--marked);border:1px solid #e9def7">Mark for Review</button>
        <button id="saveNextBtn" class="btn">Save & Next</button>

        <div style="margin-left:auto;display:flex;gap:10px;align-items:center">
          <button id="pauseBtn" class="btn ghost">Pause</button>
          <button id="restartBtn" class="btn ghost" style="background:#cfcfcf;color:#111">Restart Exam</button>
        </div>
      </div>

      <div class="qcard" id="qCard">
        <div class="qheader" id="qHeader">Question</div>
        <div class="qtext" id="qText">Loading...</div>

        <div class="options" id="optsWrap"></div>

        <div class="footer">
          <div>
            <button id="reviewAnswersBtn" class="btn ghost" style="display:none">Review Answers</button>
          </div>
          <div class="small">Questions answered: <strong id="footerAnswered">0</strong></div>
        </div>
      </div>
    </main>
  </div>

  <!-- RESULTS / REVIEW AREA -->
  <div id="resultsArea" style="display:none;padding:18px">
    <div class="results" id="resultsCard">
      <h2>Markcard & Review</h2>
      <div id="markcardSummary"></div>

      <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
        <div class="review-tabs" id="reviewTabs"></div>
        <div style="margin-left:auto;display:flex;gap:8px">
          <button id="viewMarkcardBtn" class="btn">View Markcard</button>
          <button id="backToExamBtn" class="btn ghost">Back to Exam</button>
        </div>
      </div>

      <div id="reviewContent" style="margin-top:12px"></div>
    </div>
  </div>

  <!-- START OVERLAY -->
  <div id="startOverlay" class="overlay">
    <div class="start-card">
      <h1>Start Exam</h1>
      <p class="small-muted">SSC CGL — 12 Sep Shift 2 &nbsp;•&nbsp; Duration: 60 minutes</p>
      <div style="margin-top:18px">
        <button id="startBtn" class="btn" style="font-size:18px;padding:14px 22px">Start Exam</button>
      </div>
      <p style="margin-top:14px;color:#666;font-size:13px">Click start to enter full-screen and begin.</p>
    </div>
  </div>

  <div id="pausedBadge" class="paused-badge">PAUSED</div>

<script>
/* -------------------------
  QUESTIONS: SHIFT 2 (1-100)
  (User provided full text; included here as array per section)
   Sections:
     A - Reasoning (1-25)
     B - General Awareness (26-50)
     C - Quantitative Aptitude (51-75)
     D - English Comprehension (76-100)
   Answer key embedded below.
--------------------------*/

const ANSWER_KEY = {
  "1":"C","2":"C","3":"D","4":"A","5":"A","6":"A","7":"B","8":"A","9":"B","10":"B",
  "11":"A","12":"A","13":"B","14":"D","15":"D","16":"B","17":"C","18":"C","19":"A","20":"A",
  "21":"A","22":"A","23":"B","24":"C","25":"B","26":"A","27":"C","28":"D","29":"A","30":"B",
  "31":"C","32":"A","33":"B","34":"A","35":"C","36":"C","37":"B","38":"C","39":"B","40":"B",
  "41":"C","42":"C","43":"D","44":"B","45":"A","46":"B","47":"D","48":"B","49":"D","50":"C",
  "51":"C","52":"B","53":"A","54":"B","55":"B","56":"B","57":"B","58":"D","59":"C","60":"B",
  "61":"B","62":"A","63":"B","64":"B","65":"D","66":"A","67":"A","68":"A","69":"C","70":"A",
  "71":"A","72":"C","73":"B","74":"A","75":"B","76":"C","77":"B","78":"A","79":"C","80":"A",
  "81":"A","82":"A","83":"C","84":"B","85":"C","86":"D","87":"C","88":"B","89":"B","90":"C",
  "91":"C","92":"C","93":"C","94":"C","95":"A","96":"C","97":"A","98":"C","99":"A","100":"A"
};

/* QUESTIONS array. For brevity I include the text exactly as you provided (trimmed where needed).
   Each question object: {id, q, options:[...]}.
   Note: Some OCR lines had minor duplicate or formatting. I preserved user text content.
*/

const SECTIONS = [
  { key: 'A', name:'Reasoning', items: [
    {"id":1,"q":"In the following question, select the related word from the given alternatives\nLiberty : Autonomy :: Equality : ?","options":["Legitimacy","Neutrality","Fairness","Diversity"]},
    {"id":2,"q":"Select the letter-cluster from among the given options that can replace the question mark (?) in the following series.\nBGL GLQ LQV,QVA ?","options":["785","(option placeholder)","(option placeholder)","(option placeholder)"]},
    {"id":3,"q":"Select the letter-cluster from among the given options that can replace the question mark (?) in the following series.\nDAG, FCI, ?, JGM, 110","options":["GDJ","IFL","HKE","HEK"]},
    {"id":4,"q":"Which of the following alternatives will replace the question mark?\nAtom, Molecule, Cell, ?","options":["Tissue","Proton","System","Gene"]},
    {"id":5,"q":"Complete the series: 148, 361, 361, 247, 247 ...","options":["(A)","(B)","(C)","(D)"]},
    {"id":6,"q":"What will come at the place of question mark? 2, 12, 30, 56, 90, ?","options":["132","140","142","150"]},
    {"id":7,"q":"Read statement and identify the conclusion.\nStatement: Most farmers in the region depend on monsoon rains for irrigation.\nConclusions:\n1. The region does not have proper irrigation infrastructure.\n2. A weak monsoon may reduce agricultural output.","options":["Conclusion 1 follows","Only Conclusion II follows","Only Conclusion I follows","Both I and II follow"]},
    {"id":8,"q":"Statement: The discovery of exoplanets... Assumptions:\n1. Exoplanets in habitable zones may support life.\n2. Current technology is insufficient to directly explore.\n3. If we detect life remotely, direct exploration may be unnecessary.\nChoose correct.","options":["Only I and II are implicit","Only I is implicit","All are implicit","Only II is implicit"]},
    {"id":9,"q":"How many meaningful four-letter English words can be formed using letters 1,2,3,6 of 'PROVIDE' (each used once)?","options":["One","Two","Three","None"]},
    {"id":10,"q":"Which of the following addresses are identical to each other?\n1. Rajeev Chauhan 3/5, Lotus Enclave, Kanpur, 208012\n2. Rajeev Chauhan 3-5, Lotus Enclave, Kanpur , 208012\n3. Rajeev Chauhan 3-5, Lotus Enclave, Kanpur, 208012\n4. Rajeev Chauhan 3-5, Lotus Enclave, Kanpur, 208002","options":["1 and 2","1 and 3","2 and 3","3 and 4"]},
    {"id":11,"q":"Each of the letters in the word STAMINA is arranged in alphabetical order. How many letters are there between the 1st from left and 4th from right in the new cluster?","options":["11","12","13","14"]},
    {"id":12,"q":"Find the option that best completes the analogy.\nNPR:OQS :: XVZ: ?","options":["YZA","ZAB","YAC","YAZ"]},
    {"id":13,"q":"In a row of 50 books, Book A is 15th from left and Book B is 20th from right. How many books lie between them?","options":["17","16","18","19"]},
    {"id":14,"q":"NUMERAL : UEALRMN :: ALGEBRA : ?","options":["LRBAGEA","BARLAGE","LERAGBA","LERABGA"]},
    {"id":15,"q":"Find the odd one out: TDS, GST, VAT, DNA","options":["TDS","GST","VAT","DNA"]},
    {"id":16,"q":"If A is the son of B, and B is the brother of C, how is C related to A?","options":["Father","Uncle","Brother","Cousin"]},
    {"id":17,"q":"One number is not like the others: 1331, 2197, 3375, 4096","options":["1331","3375","4096","2197"]},
    {"id":18,"q":"Find the number that breaks the pattern: 2, 5, 10, 17, 28, 40, 58","options":["10","17","28","40"]},
    {"id":19,"q":"If MOUSE=45291 and RAT=786, how is STORE coded?","options":["96571","97653","98345","96278"]},
    {"id":20,"q":"If 7$3=58 and 6$2=40, what is 5$1?","options":["24","28","22","26"]},
    {"id":21,"q":"Pointing to a girl, a woman says 'She is the daughter of my mother's only daughter.' How is the girl related to the woman?","options":["Daughter","Daughter-in-law","Cousin","Sister"]},
    {"id":22,"q":"A woman says 'This man's son's sister is my daughter.' How is the woman related to the man?","options":["Wife","Daughter-in-law","Sister","Mother"]},
    {"id":23,"q":"Two numbers are in ratio 7:9 and sum is 128. Find the numbers.","options":["49,79","56,72","62,66","70,58"]},
    {"id":24,"q":"If 16+11=A and 91—5=B and A % B = (A × B) -1, then what is A % B?","options":["(A)","(B)","(C)","(D)"]},
    {"id":25,"q":"If the sum of 28 and 22 is multiplied by 8, what is the result?","options":["384","400","415","416"]}
  ]},
  { key:'B', name:'General Awareness', items: [
    {"id":26,"q":"Assertion (A): Humayun's Tomb was the first major Mughal garden tomb and directly inspired the design of the Taj Mahal.\nReason (R): It introduced the charbagh layout and double-domed mausoleum style.","options":["Both A and R true, R correct explanation","Both true but R not correct explanation","A true R false","A false R true"]},
    {"id":27,"q":"Which ancient ruler’s administration is noted for its highly centralized structure?","options":["Harshavardhana","Samudragupta","Chandragupta Maurya","Pulakeshin II"]},
    {"id":28,"q":"Which of the following correctly reflects the evolution of Indian classical music?","options":["Jatis evolved from ragas","72-mela by Bharata","Folk music used mela and grama","Raga evolved from jatis; 72-mela by Venkatamakhi"]},
    {"id":29,"q":"Consider statements about phases of long jump:\n1) Athlete attains maximum momentum on runway before take-off.\n2) During take-off, athlete pushes off with weaker foot to maintain balance.\nWhich are correct?","options":["Only 1 correct","Only 2 correct","1 and 2 correct","Neither"]},
    {"id":30,"q":"Mary Kom's most recent international gold medal was won at which tournament?","options":["Asian Games, Hangzhou","President’s Cup, Indonesia","Commonwealth Games, Birmingham","Olympic Games, Tokyo"]},
    {"id":31,"q":"The Regulating Act of 1773 primarily introduced changes in which two areas of Company administration?","options":["Judicial system & revenue collection","Military strategy & trade regulations","Company constitution at home & territorial control","Relations with princely states & foreign policy"]},
    {"id":32,"q":"Consider statements regarding India’s water-sharing treaties:\n1) Mahakali Treaty (1996) includes integrated development of Mahakali River & Pancheshwar Project.\n2) Ganga Water Treaty (1996) allows sharing at Farakka year-round.\nWhich is correct?","options":["Only 1 is correct","Only 2 is correct","Both 1 and 2 are correct","Neither are correct"]},
    {"id":33,"q":"Fill in the blank:\nUnder the SLKIC vertical of Khelo India, Kendriya Vidyalayas have been adopted in partnership with ___ (KVS).","options":["(fill)","(fill)","(fill)","(fill)"]},
    {"id":34,"q":"Which statements about 'The Adventures of Kakababu, Volume 1' are correct?","options":["Only statement 1 correct","Only statement 2 correct","Statements 2 and 3 correct","1,2 and 3 correct"]},
    {"id":35,"q":"Which Indian political leader addressed a special session in 2025 on 'Environment, COP-30, and Global Health'?","options":["Piyush Goyal","Hardeep Puri","Narendra Modi","S. Jaishankar"]},
    {"id":36,"q":"Which type of landslide involves backward rotation of the slipping material?","options":["Rockslide","Rock fall","Slump","Debris fall"]},
    {"id":37,"q":"What is meant by population density?","options":["Population per household","People per square kilometre","People per region","People per district"]},
    {"id":38,"q":"Assertion (A): Population explosion occurs when death rates decline rapidly but birth rates remain high.\nReason (R): Societal reproductive behaviour changes instantly with healthcare improvements.\nChoose.","options":["Both A and R true, R correct","Both true but R not correct","A true R false","A false R true"]},
    {"id":39,"q":"What is the fundamental objective of applying generative design in aerospace systems engineering?","options":["Facilitating multi-payload integration","Optimizing mechanical configs for minimum mass & max resilience","Enhancing life-support redundancies","Designing adaptive thrust mechanisms"]},
    {"id":40,"q":"The function of lysosomes in cells is:","options":["Protein synthesis","Intracellular digestion","Energy production","Genetic info storage"]},
    {"id":41,"q":"Which of the following statements regarding Article 270 are correct?\n1) Article 270 governs sharing of taxes between Union and States including GST proceeds.\n2) After 101st amendment, Article 270 includes provisions for distributing revenue from Union taxes and GST.\n3) GST Compensation Cess is shared under Article 270.","options":["1 and 3 only","1 only","1 & 2 only","2 & 3 only"]},
    {"id":42,"q":"If Earth's radius were reduced by 1% while mass unchanged, effect on surface gravitational acceleration?","options":["Increase ~1%","Decrease ~2%","Increase ~2%","Decrease ~1%"]},
    {"id":43,"q":"Under BNSS, maximum period a person can be held in police custody in total even if remanded periodically?","options":["30 days","60 days","90 days","15 days (initial remand)"]},
    {"id":44,"q":"Age range for farmers to enrol in PM-KMY?","options":["18-30 years","18-40 years","21-45 years","25-50 years"]},
    {"id":45,"q":"Assertion (A): UDAN improves regional air connectivity.\nReason (R): It provides viability gap funding to airlines.\nChoose correct.","options":["Both A and R true, R correct","Both true but R not correct","A true R false","A false R true"]},
    {"id":46,"q":"According to Global Cities Index 2025, which two cities retained top positions?","options":["Tokyo & Beijing","London & New York","Paris & Rome","Berlin & Moscow"]},
    {"id":47,"q":"Which statement about light industries is correct?","options":["They process heavy ores and minerals","They produce large-scale industrial machinery","They require bulky raw materials","They use light materials to make consumer goods"]},
    {"id":48,"q":"Schedule VII of the Constitution contains:","options":["Election guidelines","Three legislative lists","Emergency powers","Judicial provisions"]},
    {"id":49,"q":"A coastal city builds sea walls and elevates buildings; this action primarily falls under which category?","options":["Climate change mitigation","Carbon sequestration","Geoengineering","Climate change adaptation"]},
    {"id":50,"q":"What ensures a satellite maintains its orbit without continuous propulsion?","options":["Mass","Gravitational pull","Orbital velocity","Atmospheric drag"]}
  ]},
  { key:'C', name:'Quantitative Aptitude', items: [
    {"id":51,"q":"Let x = √3 + √5 and y = √8 + √2. Which is greater?","options":["x","y","Cannot be determined","Equal"]},
    {"id":52,"q":"Red, blue, green marbles ratio 3:4:6. After adding 20 red,15 blue & g green, ratio becomes 4:5:7. How many green added?","options":["(A)","(B)","(C)","(D)"]},
    {"id":53,"q":"Evaluate the continued fraction: x = 2 + 1/(2 + 1/(2 + ...)).","options":["(A)","(B)","(C)","(D)"]},
    {"id":54,"q":"A and B invest 40,000 and 60,000 respectively. What is A's share of profit 50,000?","options":["₹15,000","₹20,000","₹25,000","₹30,000"]},
    {"id":55,"q":"A and B invest in ratio 3:5. Profit ₹64,000. A is working partner and gets extra 10% of profit. What is A's total share?","options":["(A)","(B)","(C)","(D)"]},
    {"id":56,"q":"Team of 75 employees average monthly sales per employee ₹1.8 lakh. 30 junior employees average ₹1.2 lakh. What is average for senior employees?","options":["₹2.2 lakh","₹2.8 lakh","₹1.42 lakh","Other"]},
    {"id":57,"q":"Petrol price up 5% from ₹82/litre. Man travels 3045 km/month, car mileage 15 km/l. Increase in monthly expenditure?","options":["2820","7820","7845","7850"]},
    {"id":58,"q":"Company ordered 20 high-end laptops and some desktops. High-end price = 5× desktop. Numbers interchanged in delivery causing total bill to increase by 80%. Ratio of laptops to desktops originally?","options":["1:2","2:5","(C)","(D)"]},
    {"id":59,"q":"Find compound interest on ₹78,000 at 12% p.a. for 3 years 4 months compounded annually.","options":["₹3,000","₹73,689","₹73,600","Other"]},
    {"id":60,"q":"Candy shop mixes candies costing (3 for ₹15), (4 for ₹18), (5 for ₹22) in ratio 1:1:2; sells 2 for ₹10. Approximate gain/loss %?","options":["Loss 9.2%","Profit 9.29%","Profit 10%","Loss 10%"]},
    {"id":61,"q":"Boys:girls=7:5. 20 more girls -> new ratio 7:6. Initial total students?","options":["200","240","300","360"]},
    {"id":62,"q":"A,B,C can finish job in 30,45,90 days. A works every day, B and C join every fifth day. How long to finish?","options":["25 days","18 days","16 days","12 days"]},
    {"id":63,"q":"100 litre solution acid:water=3:2. Replace some with pure acid; final ratio 7:3. How many litres replaced?","options":["35","25","50","20"]},
    {"id":64,"q":"P:Q efficiencies 5:2. If P completes in 12 days, Q will take?","options":["24","30","35","40"]},
    {"id":65,"q":"Car starts from P, SUV from Q 600 m ahead. Car speed 15 m/s, SUV 10 m/s. Track circumference 1.5 km. Distance car travels when it first overtakes SUV?","options":["900 m","1200 m","1500 m","1800 m"]},
    {"id":66,"q":"Circular park radius 14 m. A path 1.5 m wide around it. Approx area of the path?","options":["139 m²","135 m²","142 m²","150 m²"]},
    {"id":67,"q":"What is (4π/5) radians in degrees?","options":["180°","240°","360°","Other"]},
    {"id":68,"q":"Line y = -x + 4 passes through which point?","options":["(2,2)","(5,4)","(1,2)","(3,6)"]},
    {"id":69,"q":"Central angle of sector with arc length 10 cm and radius 5 cm?","options":["6 radians","3 radians","2 radians","4 radians"]},
    {"id":70,"q":"If tan(90° - A) = √3, what is sin A?","options":["(A)","(B)","(C)","(D)"]},
    {"id":71,"q":"If x = √7, determine value of x + x^-1 ?","options":["(A)","(B)","(C)","(D)"]},
    {"id":72,"q":"Two triangles similar sides ratio 3:5. Ratio of areas?","options":["9:25","3:5","(C)","(D)"]},
    {"id":73,"q":"If x = √( —2√3 + 2√3 ) then determine x^2 + x - 9 ?","options":["3√3","7√3","9√3","Other"]},
    {"id":74,"q":"Angles of cyclic quadrilateral in ratio 1:2:3:4. Smallest angle measure?","options":["36°","72°","108°","144°"]},
    {"id":75,"q":"If sec A = 5/3 and A is acute, find sin A.","options":["(A)","(B)","(C)","(D)"]}
  ]},
  { key:'D', name:'English Comprehension', items: [
    {"id":76,"q":"Select the most appropriate synonym of the given word: ABNEGATE","options":["Demand","Accept","Renounce","Support"]},
    {"id":77,"q":"Choose the correct meaning of idiom: Move heaven and earth","options":["To relocate frequently","To work tirelessly to achieve something","To stay silent in protest","To follow blindly"]},
    {"id":78,"q":"Select the most appropriate antonym of the given word: Puissant","options":["Robust","Powerful","Strong","Weak"]},
    {"id":79,"q":"Identify the misspelt word","options":["Supersede","Perseverance","Privilege","Assassinate"]},
    {"id":80,"q":"Spot the correct spelling of a drug-effect psychology field.","options":["Psychopharmacology","Psychopharmacholog","Psychopharmeocology","Psychopharmocology"]},
    {"id":81,"q":"Choose the correct one-word substitute for: 'A person who abstains from all forms of indulgence'.","options":["Ascetic","Agnostic","Mystic","Skeptic"]},
    {"id":82,"q":"Select the correct option:\nNeither the principal investigator ___ the co-authors anticipated the backlash.","options":["or","and","nor did","but"]},
    {"id":83,"q":"Select the correct option:\nThe board will convene next Friday, ___ final approval is expected.","options":["at which","on which","when","whereupon"]},
    {"id":84,"q":"Select the correct option:\nNothing short of a paradigm shift will ___ the entrenched bureaucratic inertia.","options":["persuade","dislodge","dissuade","disillusion"]},
    {"id":85,"q":"Find the part of the sentence that contains an error:\nMuch of what appears to be coordination (1)/ among the regulatory bodies and private stakeholders (2)/ are, in fact, coincidental overlaps (3)/ caused by differing mandates. (4)","options":["(1)","(2)","(3)","(4)"]},
    {"id":86,"q":"Find the part of the sentence that contains an error:\nThat the framework lacks provisions for backward compatibility (1)/ is less problematic than the assumption (2)/ that all peripheral institutions will, without coercion, (3)/ adheres to the central directive as framed. (4)","options":["(1)","(2)","(3)","(4)"]},
    {"id":87,"q":"Change the following from active to passive:\nPeople can seldom access archived manuscripts without clearance.","options":["Archived manuscripts can seldom be accessed without clearance.","Archived manuscripts can seldom being accessed without clearance.","Archived manuscripts could seldom be accessed without clearance.","Archived manuscripts are seldom able to be accessed without clearance."]},
    {"id":88,"q":"Select the sentence containing the homonym of the highlighted word:\nThe prince’s gules dominated the family coat of arms.","options":["The tapestry featured gules and argent prominently.","The chef prepared a sauce of deep gules and cumin.","The gules border signified martial lineage.","The herald explained the symbolism of gules to visitors."]},
    {"id":89,"q":"Convert passive to active:\nThe package is delivered to the office every morning.","options":["The office delivers the package every morning.","Someone delivers the package to the office every morning.","The office has delivered the package every morning.","The package delivers itself to the office every morning."]},
    {"id":90,"q":"Passage: The proliferation of social media... (see full passage). Q: What primary democratic function does social media serve, as per the paragraph?","options":["Promoting entertainment","Replacing newspapers","Facilitating free flow of information","Organizing trade unions"]},
    {"id":91,"q":"Q: What makes social media a double-edged tool in democratic societies?","options":["Its affordability","Its visual design","Its ability to spread both truth and misinformation","Its international reach"]},
    {"id":92,"q":"Q: According to the paragraph, which element amplifies marginalized voices through social media?","options":["Editorial boards","Gatekeeping journalism","Viral reach and grassroots mobilization","Institutional press"]},
    {"id":93,"q":"Q: What does the author suggest as a critical solution to social media misuse in democracies?","options":["Enhanced meme culture","Legalizing all content","Algorithmic transparency and media literacy","Global censorship policies"]},
    {"id":94,"q":"Q: In the author's view, what determines whether social media supports or undermines democracy?","options":["Political advertisements","How platforms are funded","Societal intent and ethical usage","Popularity of influencers"]},
    {"id":95,"q":"Choose the most suitable option: No sooner had I reached the station when the train departed. Replace.","options":["than the train departed","then the train departed","when the train had departed","than did the train depart"]},
    {"id":96,"q":"Choose the most suitable option: The manager asked the clerk to submit the report.","options":["asked the clerk that submit the report","requested the clerk to submit report","asked the clerk to submit the report","told to the clerk submit report"]},
    {"id":97,"q":"Direct to indirect: She said, 'I saw him last night.'","options":["She said she had seen him the previous night.","She said she has seen him last night.","She said she was seeing him last night.","She said she had saw him the previous night."]},
    {"id":98,"q":"Indirect to direct: The librarian said that silence must be maintained in the library.","options":["'Silence should be maintained in the library,' said the librarian.","'You will maintain silence in the library,' the librarian said.","'Maintain silence in the library,' said the librarian.","'Must you maintain silence?' asked the librarian."]},
    {"id":99,"q":"Rearrange to form a paragraph:\n1. Consequently, effective communication hinges on more than just the words we choose.\n2. Non-verbal cues ...\n3. Communication is a complex process ...\n4. It's often the subtle signals ...","options":["3,2,1,4","2,4,1,3","1,4,3,2","3,4,2,1"]},
    {"id":100,"q":"Rearrange to form a coherent paragraph about energy transition (4 sentences given).","options":["2,1,3,4","2,1,3,4 (alt)","(C)","(D)"]}
  ]}
];

/* ---------- State ---------- */
const STATE_KEY = 'ssc_shift2_state_v1';

let state = {
  currentSectionIndex: 0, // 0-3
  currentQuestionIndex: 0,
  answers: {},            // key: "id" -> option letter ("A"/"B"/"C"/"D")
  marked: {},             // id -> true
  skipped: {},            // id -> true
  timerSeconds: 60*60,    // 60 minutes
  running: false,
  paused: false,
  submitted: false,
  sectionTimes: { A:0, B:0, C:0, D:0 }, // seconds
  sectionActiveStart: null // timestamp when section became active (for accumulating)
};

/* ---------- Helpers ---------- */
const el = id => document.getElementById(id);
const formatTime = s => {
  if(s < 0) s = 0;
  const mm = String(Math.floor(s/60)).padStart(2,'0');
  const ss = String(s%60).padStart(2,'0');
  return `${mm}:${ss}`;
};
const secToHMS = s => {
  const hh = Math.floor(s/3600); const mm = Math.floor((s%3600)/60); const ss = s%60;
  return `${String(hh).padStart(2,'0')}:${String(mm).padStart(2,'0')}:${String(ss).padStart(2,'0')}`;
};
const saveState = () => localStorage.setItem(STATE_KEY, JSON.stringify(state));
const loadState = () => {
  const raw = localStorage.getItem(STATE_KEY);
  if(raw) {
    try { Object.assign(state, JSON.parse(raw)); } catch(e){ console.warn('load failed',e); }
  }
};

/* ---------- Timer ---------- */
let timerInterval = null;
function startGlobalTimer(){
  if(timerInterval) clearInterval(timerInterval);
  state.running = true;
  timerInterval = setInterval(()=>{
    if(state.paused || !state.running) return;
    state.timerSeconds--;
    // accumulate section active time if a section is active
    if(state.sectionActiveStart) {
      // we accumulate when switching sections, not every tick to avoid heavy writes; but keep state up to date
    }
    if(state.timerSeconds <= 0){
      clearInterval(timerInterval);
      state.timerSeconds = 0;
      doSubmit();
    }
    renderTime();
    saveState();
  }, 1000);
}
function stopGlobalTimer(){
  if(timerInterval) clearInterval(timerInterval);
  state.running = false;
}

/* ---------- UI init ---------- */

function buildSectionButtons(){
  const wrap = el('sectionList'); wrap.innerHTML = '';
  SECTIONS.forEach((sec, idx) => {
    const b = document.createElement('button');
    b.className = 'section-btn' + (idx === state.currentSectionIndex ? ' active' : '');
    b.innerText = `${sec.name} (${sec.items.length})`;
    b.onclick = () => switchSection(idx);
    wrap.appendChild(b);
  });
}

function buildGrid(){
  const wrap = el('qGrid'); wrap.innerHTML = '';
  const sec = SECTIONS[state.currentSectionIndex];
  sec.items.forEach((q, idx) => {
    const key = String(q.id);
    const btn = document.createElement('button');
    btn.className = 'qnum';
    if(state.marked[key]) btn.classList.add('marked');
    else if(state.skipped[key]) btn.classList.add('skipped');
    else if(state.answers[key]) btn.classList.add('answered');
    btn.innerText = idx + 1;
    btn.title = `Q${q.id}`;
    btn.onclick = () => { state.currentQuestionIndex = idx; renderQuestion(); };
    wrap.appendChild(btn);
  });
  updateSectionSummary();
}

function updateSectionSummary(){
  const sec = SECTIONS[state.currentSectionIndex];
  const answered = sec.items.reduce((a,q)=> a + (state.answers[String(q.id)]?1:0),0);
  el('secAnswered').innerText = answered;
  el('secNotAnswered').innerText = sec.items.length - answered;
}

function updateTotals(){
  const total = Object.keys(state.answers).length;
  el('totalAnswered').innerText = total;
  el('footerAnswered').innerText = total;
}

/* ---------- Render question ---------- */
function renderQuestion(reviewMode=false){
  const sec = SECTIONS[state.currentSectionIndex];
  if(!sec) return;
  const q = sec.items[state.currentQuestionIndex];
  el('qHeader').innerText = `Section: ${sec.name} — Q${q.id}`;
  el('qText').innerHTML = q.q.replace(/\n/g,'<br>');
  const optsWrap = el('optsWrap'); optsWrap.innerHTML = '';
  const key = String(q.id);
  const letters = ['A','B','C','D'];
  q.options.forEach((optText, i) => {
    const letter = letters[i] || String.fromCharCode(65+i);
    const lab = document.createElement('label');
    lab.className = 'opt';
    const radio = document.createElement('input');
    radio.type = 'radio'; radio.name = 'optRadio';
    radio.disabled = state.paused || state.submitted;
    radio.checked = state.answers[key] === letter;
    radio.onchange = () => {
      if(state.paused || state.submitted) return;
      state.answers[key] = letter;
      state.skipped[key] = false;
      saveState(); buildGrid(); updateTotals();
    };
    const txt = document.createElement('span'); txt.innerText = `${letter}. ${optText}`;
    lab.appendChild(radio); lab.appendChild(txt);

    // click on whole label selects
    lab.onclick = (e) => {
      if(state.paused || state.submitted) return;
      state.answers[key] = letter;
      state.skipped[key] = false;
      saveState(); buildGrid(); updateTotals();
      radio.checked = true;
    };

    // review highlighting
    if(state.submitted){
      const correct = ANSWER_KEY[key];
      if(correct === letter) lab.classList.add('correct');
      if(state.answers[key] && state.answers[key] === letter && state.answers[key] !== correct) lab.classList.add('wrong');
      // disable interactions
      radio.disabled = true;
    }

    if(state.paused){ lab.classList.add('disabled'); radio.disabled = true; }

    optsWrap.appendChild(lab);
  });
  updateTotals();
  buildGrid();
  updateSectionSummary();
}

/* ---------- Navigation ---------- */
function saveAndNext(){
  const sec = SECTIONS[state.currentSectionIndex];
  const q = sec.items[state.currentQuestionIndex];
  const key = String(q.id);
  if(!state.answers[key]) state.skipped[key] = true;
  else state.skipped[key] = false;
  if(state.currentQuestionIndex < sec.items.length - 1) state.currentQuestionIndex++;
  else if(state.currentSectionIndex < SECTIONS.length - 1){
    switchSection(state.currentSectionIndex + 1);
    state.currentQuestionIndex = 0;
  }
  renderQuestion();
  saveState();
}

function goPrev(){
  if(state.currentQuestionIndex > 0){ state.currentQuestionIndex--; renderQuestion(); return; }
  if(state.currentSectionIndex > 0){
    switchSection(state.currentSectionIndex - 1);
    state.currentQuestionIndex = SECTIONS[state.currentSectionIndex].items.length - 1;
    renderQuestion();
  }
}

function clearResponse(){
  const sec = SECTIONS[state.currentSectionIndex];
  const q = sec.items[state.currentQuestionIndex];
  const key = String(q.id);
  delete state.answers[key];
  state.skipped[key] = true;
  saveState(); buildGrid(); updateTotals(); renderQuestion();
}

function markForReview(){
  const sec = SECTIONS[state.currentSectionIndex];
  const q = sec.items[state.currentQuestionIndex];
  const key = String(q.id);
  state.marked[key] = true;
  // move next
  saveAndNext();
  saveState();
}

/* ---------- Section switch & per-section time tracking ---------- */
function switchSection(newIndex){
  if(newIndex === state.currentSectionIndex) return;
  // accumulate time for current active section
  accumulateSectionTime();
  // change current section
  state.currentSectionIndex = newIndex;
  // reset question index if out of bounds
  state.currentQuestionIndex = 0;
  // set new section active start if running and not paused
  if(!state.paused && state.running){
    state.sectionActiveStart = Date.now();
  } else {
    state.sectionActiveStart = null;
  }
  buildSectionButtons();
  buildGrid();
  renderQuestion();
  saveState();
}

function accumulateSectionTime(){
  const idx = state.currentSectionIndex;
  const secKey = SECTIONS[idx].key;
  if(state.sectionActiveStart){
    const elapsed = Math.floor((Date.now() - state.sectionActiveStart)/1000);
    if(!isNaN(elapsed) && elapsed > 0) {
      state.sectionTimes[secKey] = (state.sectionTimes[secKey] || 0) + elapsed;
    }
    state.sectionActiveStart = null;
  }
}

/* ---------- Pause / Resume ---------- */
function setPaused(on){
  state.paused = on;
  el('pauseBtn').innerText = on ? 'Resume' : 'Pause';
  // show badge
  el('pausedBadge').style.display = on ? 'block' : 'none';
  // when pausing, stop accumulating section active time
  if(on){
    // accumulate current active
    accumulateSectionTime();
  } else {
    // resume section active timing
    if(state.running){
      state.sectionActiveStart = Date.now();
    }
  }
  renderQuestion();
  saveState();
}

/* ---------- Fullscreen ---------- */
async function toggleFullscreen(){
  try{
    if(!document.fullscreenElement){
      await document.documentElement.requestFullscreen();
      el('fsBtn').innerText = 'Exit full-screen';
    } else {
      await document.exitFullscreen();
      el('fsBtn').innerText = 'Full screen';
    }
  }catch(e){ console.warn('fs',e); }
}

/* ---------- Submit / Scoring ---------- */
function doSubmit(){
  if(state.submitted) return;
  // finalize timers
  accumulateSectionTime();
  // stop timer
  stopGlobalTimer();
  state.submitted = true;
  // compute score
  const result = computeResults();
  // show result area and review
  showResults(result);
  saveState();
}

function computeResults(){
  let totalCorrect = 0, totalAttempted = 0;
  const perSection = {};
  SECTIONS.forEach(sec=>{
    const key = sec.key;
    perSection[key] = { correct:0, attempted:0, total: sec.items.length, time: state.sectionTimes[key] || 0 };
    sec.items.forEach(q=>{
      const ans = state.answers[String(q.id)];
      if(ans) perSection[key].attempted++;
      if(ans && ANSWER_KEY[String(q.id)] === ans) perSection[key].correct++;
    });
    totalCorrect += perSection[key].correct;
    totalAttempted += perSection[key].attempted;
  });
  const totalMarks = totalCorrect; // simple 1 mark per correct — change if needed
  const totalQuestions = SECTIONS.reduce((a,s)=>a+s.items.length,0);
  return { perSection, totalCorrect, totalAttempted, totalMarks, totalQuestions };
}

function showResults(result){
  el('resultsArea').style.display = 'block';
  // build markcard summary
  const container = el('markcardSummary');
  container.innerHTML = '';
  const table = document.createElement('table');
  const thead = document.createElement('thead');
  thead.innerHTML = `<tr><th>Section</th><th>Total Qs</th><th>Attempted</th><th>Correct</th><th>Wrong</th><th>Time Spent</th></tr>`;
  const tbody = document.createElement('tbody');
  for(const sec of SECTIONS){
    const info = result.perSection[sec.key];
    const wrong = info.attempted - info.correct;
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${sec.name}</td><td>${info.total}</td><td>${info.attempted}</td><td>${info.correct}</td><td>${wrong}</td><td>${secToHMS(info.time)}</td>`;
    tbody.appendChild(tr);
  }
  const totalRow = document.createElement('tr');
  totalRow.innerHTML = `<th>Total</th><th>${result.totalQuestions}</th><th>${result.totalAttempted}</th><th>${result.totalCorrect}</th><th>${result.totalAttempted - result.totalCorrect}</th><th>-</th>`;
  tbody.appendChild(totalRow);
  table.appendChild(thead); table.appendChild(tbody);
  container.appendChild(table);

  // build review tabs
  const reviewTabs = el('reviewTabs'); reviewTabs.innerHTML = '';
  SECTIONS.forEach((sec, idx)=>{
    const b = document.createElement('div');
    b.className = 'tab' + (idx===0?' active':'');
    b.innerText = `${sec.name}`;
    b.onclick = () => {
      // set active
      Array.from(reviewTabs.children).forEach(c=>c.classList.remove('active'));
      b.classList.add('active');
      renderReviewSection(idx);
    };
    reviewTabs.appendChild(b);
  });

  // initial content
  renderReviewSection(0);
  // show view markcard button visible
  el('viewMarkcardBtn').style.display = 'inline-block';
}

/* ---------- Review rendering ---------- */
function renderReviewSection(secIndex){
  const content = el('reviewContent'); content.innerHTML = '';
  const sec = SECTIONS[secIndex];
  // list question tiles with status right/wrong
  const listWrap = document.createElement('div');
  listWrap.className = 'review-list';
  sec.items.forEach((q, idx) => {
    const id = String(q.id);
    const div = document.createElement('div');
    div.className = 'rev-q';
    const ans = state.answers[id];
    const correct = ANSWER_KEY[id];
    const status = (!ans) ? 'Unattempted' : (ans === correct ? 'Correct' : 'Wrong');
    div.innerHTML = `<div style="font-weight:800">Q${q.id}</div><div style="font-size:12px;color:#666;margin-top:6px">${status}</div>`;
    if(status === 'Correct') div.style.background = '#e9f7ef';
    if(status === 'Wrong') div.style.background = '#fff3f3';
    div.onclick = () => {
      // show this question in review display below
      renderReviewQuestion(secIndex, idx);
    };
    listWrap.appendChild(div);
  });
  content.appendChild(listWrap);
  // show first question by default
  renderReviewQuestion(secIndex, 0);
}

function renderReviewQuestion(secIndex, qIndex){
  const sec = SECTIONS[secIndex];
  const q = sec.items[qIndex];
  const content = el('reviewContent');
  // create detail view
  const detail = document.createElement('div');
  detail.style.marginTop = '12px';
  detail.style.background = '#fff';
  detail.style.padding = '12px';
  detail.style.borderRadius = '8px';
  detail.style.border = '1px solid #e6eef8';
  detail.innerHTML = `<div style="font-weight:800;margin-bottom:8px">${sec.name} — Q${q.id}</div><div style="margin-bottom:10px">${q.q.replace(/\n/g,'<br>')}</div>`;
  // options with highlighting
  const letters = ['A','B','C','D'];
  const ul = document.createElement('div');
  q.options.forEach((opt, i)=>{
    const letter = letters[i];
    const optDiv = document.createElement('div');
    optDiv.style.padding='8px'; optDiv.style.borderRadius='6px'; optDiv.style.marginBottom='6px'; optDiv.style.border='1px solid #eef6ff';
    const correct = ANSWER_KEY[String(q.id)];
    if(letter === correct) optDiv.style.background = 'var(--correct)';
    if(state.answers[String(q.id)] === letter && state.answers[String(q.id)] !== correct) optDiv.style.background = 'var(--wrong)';
    optDiv.innerText = `${letter}. ${opt}`;
    detail.appendChild(optDiv);
  });
  // show your choice and correct
  const your = state.answers[String(q.id)] || 'Unattempted';
  const correct = ANSWER_KEY[String(q.id)];
  const footer = document.createElement('div');
  footer.style.marginTop='10px';
  footer.innerHTML = `<strong>Your answer:</strong> ${your} &nbsp;&nbsp; <strong>Correct:</strong> ${correct}`;
  detail.appendChild(footer);
  // add button to view markcard
  const btnWrap = document.createElement('div'); btnWrap.style.marginTop='12px';
  const viewMark = document.createElement('button'); viewMark.className='btn'; viewMark.innerText='View Markcard';
  viewMark.onclick = () => {
    // scroll to markcard summary
    window.scrollTo({top:0,behavior:'smooth'});
  };
  btnWrap.appendChild(viewMark);
  detail.appendChild(btnWrap);

  // replace old detailed area
  // keep the list, append detail after it
  // remove any existing detail nodes
  // find listWrap and append
  const listWrap = content.querySelector('.review-list');
  // remove any existing detail nodes after listWrap
  while(listWrap.nextSibling) listWrap.parentNode.removeChild(listWrap.nextSibling);
  listWrap.parentNode.appendChild(detail);
}

/* ---------- Restart ---------- */
function restartExam(){
  if(!confirm('Restart exam? This will clear all saved progress.')) return;
  // clear localStorage and reset state
  localStorage.removeItem(STATE_KEY);
  location.reload();
}

/* ---------- Persistence load ---------- */
function initFromStorage(){
  loadState();
  // if submitted in storage, show results immediately
  buildSectionButtons();
  buildGrid();
  renderQuestion();
  renderTime();
  updateTotals();
  if(state.submitted){
    startGlobalTimer(); // not running but maintain functions
    stopGlobalTimer();
    const res = computeResults();
    showResults(res);
  } else {
    // resume timer if running
    if(state.running && !state.paused){
      // set sectionActiveStart to now to resume accumulation
      state.sectionActiveStart = Date.now();
      startGlobalTimer();
    } else {
      renderTime();
    }
  }
}

/* ---------- Render time ---------- */
function renderTime(){
  el('timeBox').innerText = formatTime(state.timerSeconds);
}

/* ---------- Start exam flow ---------- */
async function onStartClick(){
  // enter fullscreen
  try{
    if(!document.fullscreenElement) await document.documentElement.requestFullscreen();
  }catch(e){ console.warn('fs failed', e); }
  // initialize state
  state.timerSeconds = 60 * 60; // 60 minutes
  state.running = true;
  state.paused = false;
  state.submitted = false;
  state.answers = {};
  state.marked = {};
  state.skipped = {};
  state.sectionTimes = { A:0, B:0, C:0, D:0 };
  state.sectionActiveStart = Date.now();
  state.currentSectionIndex = 0;
  state.currentQuestionIndex = 0;
  saveState();
  el('startOverlay').style.display = 'none';
  buildSectionButtons();
  buildGrid();
  renderQuestion();
  startGlobalTimer();
}

/* ---------- Event bindings ---------- */
document.addEventListener('DOMContentLoaded', ()=>{
  // wire buttons
  el('startBtn').onclick = onStartClick;
  el('fsBtn').onclick = toggleFullscreen;
  el('pauseBtn').onclick = () => {
    setPaused(!state.paused);
    saveState();
  };
  el('restartBtn').onclick = restartExam;
  el('saveNextBtn').onclick = () => { saveAndNext(); };
  el('prevBtn').onclick = goPrev;
  el('clearBtn').onclick = clearResponse;
  el('markBtn').onclick = markForReview;
  el('submitTop').onclick = () => {
    if(!confirm('Submit exam now?')) return;
    doSubmit();
  };
  el('viewMarkcardBtn').onclick = () => {
    // scroll to markcard summary
    window.scrollTo({top:0,behavior:'smooth'});
  };
  el('backToExamBtn').onclick = () => {
    // hide results area and show exam UI (scroll)
    el('resultsArea').style.display = 'none';
    // allow navigating back to exam UI: if exam not submitted, allow
    // If exam submitted and user wants to revisit exam screen, we still keep submitted true and review UI will be read-only
    window.scrollTo({top:0,behavior:'smooth'});
  };

  // reviewAnswersBtn (hidden during exam) — show after submit
  el('reviewAnswersBtn').onclick = () => {
    const res = computeResults();
    showResults(res);
    el('resultsArea').scrollIntoView({behavior:'smooth'});
  };

  // handle visibility change: if user switches tab, pause accumulation & timer continues but we track sectionActiveStart properly
  document.addEventListener('visibilitychange', () => {
    if(document.hidden){
      // accumulate current section time chunk
      accumulateSectionTime();
    } else {
      if(!state.paused && state.running){
        state.sectionActiveStart = Date.now();
      }
    }
  });

  // load saved state if present
  initFromStorage();
});

/* Save state periodically */
setInterval(()=>saveState(), 5000);

</script>
</body>
</html>
